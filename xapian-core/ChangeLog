Sat Aug 10 15:12:42 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed missing include in quartzcheck.cc

Sat Aug 10 14:57:17 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed typo in quartzcheck.cc

Tue Jul 23 22:12:34 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Added a note to the effect that the indexgraph stuff isn't
 	  really considered useful to the HTML document introducing it.

Tue Jul 23 22:09:39 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Added some comments in quartztest test_create1(), in case anyone
	  else who didn't write it needs to understand it.
	
	* Added Olly as an active participant to the AUTHORS file :)

Tue Jul 23 21:59:50 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Reworded quickstart document so it does not refer to the example
 	  code (it was never actually in sync).

Mon Jul 22 14:07:18 BST 2002  Sam Liddicott <saml@ananova.net>

	* Forgot to actually add the quartzcheck.cc file last time

Mon Jul 22 13:28:09 BST 2002  Sam Liddicott <saml@ananova.net>

	* Add buildprereq to package
	  Add quartzcheck which runs btree::check to backends 

Tue Jul 16 09:44:56 BST 2002  Sam Liddicott <saml@ananova.net>

	* Fix banding problem; bands are now based on the percentage
	  not the weight, and using integer maths to avoid problems 
	  with ceil() rounding up supposed integers which are really
	  slightly larger due to precision errors

Thu Jul 11 00:16:22 BST 2002  Olly Betts <olly@survex.com>

	* configure.in, docs/Makefile.am: configure fixes for Solaris - clear
	  cached result for fdatasync since it may be wrong if we decide we
	  need to link librt; split SOURCEDOC_SRC into two to avoid hitting
	  4096 char line length in Solaris sed.

Tue Jul 09 17:47:31 BST 2002  Olly Betts <olly@survex.com>

	* PLATFORMS, tests/Makefile.am: improved internaltest.cc automake rules
	  - they should now work in VPATH builds with Solaris make.

Tue Jul 09 03:30:41 BST 2002  Olly Betts <olly@survex.com>

	* configure.in, docs/Makefile.am: Fixed up apidoc and sourcedoc
	  dependencies so that they work correctly in VPATH builds.  Also
	  only use portable find arguments to generate SOURCEDOC_SRC.

Sat Jul 06 13:53:27 BST 2002  Olly Betts <olly@survex.com>

	* xapian.spec.in: Updated in preparation for release.

Sat Jul 06 13:04:45 BST 2002  Olly Betts <olly@survex.com>

	* docs/Makefile.am: Run latex twice to get forward references resolved.

Fri Jul 05 18:23:08 BST 2002  Olly Betts <olly@survex.com>

	* matcher/multimatch.cc: better (perhaps even completely correct) fix
	  for sorting into bands.

	* matcer/localmatch.cc: removed entirely bogus comment from over-eager
	  cut-and-paste.

	* tests/api_db.cc: added otherwise pointless statement to deldoc3
	  which seems to fix occasional miscompilation by GCC 2.95.

Fri Jul 05 16:37:12 BST 2002  Olly Betts <olly@survex.com>

	* docs/Makefile.am: "make dist" now fails if dot (part of graphviz)
	  isn't installed.

Fri Jul 05 08:54:33 BST 2002  Sam Liddicott <sam@ananova.com>

	* bindings/: removed some typemap hacks as swig has better typemaps now

Fri Jul 05 08:46:06 BST 2002  Sam Liddicott <sam@ananova.com>

	* matcher/multimatch.cc: Quick hack to stop 100% being in a band all on
	  its own.  The real problem is that bands need to include the integer
	  at the upper end of the range, rather than the lower end.

Thu Jul 04 16:23:52 BST 2002  Olly Betts <olly@survex.com>

	* docs/mkdoc.pl: Fixed to work in VPATH builds.

Thu Jul 04 12:42:06 BST 2002  Olly Betts <olly@survex.com>

	* configure.in, docs/Makefile.am: use "missing" to give more helpful
	  errors when we don't find tools we need.

Wed Jul 03 12:39:15 BST 2002  Olly Betts <olly@survex.com>

	* NEWS: incorporated recent changes into provisional version.

	* docs/: sorted out make rules for running doxygen; don't tell doxygen
	  to build man pages which we aren't using.

Tue Jul 02 16:36:54 BST 2002  Olly Betts <olly@survex.com>

	* docs/: run through ispell; fixed OM_MOP to OmQuery::OP; other
	  corrections.

Fri Jun 28 02:59:49 BST 2002  Olly Betts <olly@survex.com>

	* Backend "auto" now works when creating an OmWritableDatabase which
	  doesn't already exist - it'll pick a backend which supports writing
	  and is compiled in (currently this means quartz).

Thu Jun 27 20:31:13 BST 2002  Richard Boulton <richard@tartarus.org>

	* backends/quartz/btreetest.cc (sequent1): Add regression test for
	  recently fixed bug with sequential addition.
	* backends/quartz/z_data/ordnum[+-]: Data files for new test.

Thu Jun 27 13:13:37 BST 2002  Olly Betts <olly@survex.com>

	* Documentation fettling: removed docs/Notes and
	  docs/coding_policy.txt moving relevant content into HACKING,
	  common/postlist.h, docs/todo.xml, and include/om/omtypes.h; install
	  docs as PostScript rather than DVI; include text docs in tarball and
	  install them; "make dist" will now fail if a tool needed to build
	  docs is missing; removed last vestiges of Doc++ support;
	  doc/Makefile no longer uses include (include isn't portable);
	  improved doc/tests.txt. 

Thu Jun 27 12:10:37 BST 2002  Olly Betts <olly@survex.com>

	* apitest: doesn't directly use anything from utils.h, so don't
	  #include it.

Thu Jun 27 12:05:53 BST 2002  Olly Betts <olly@survex.com>

	* Removed includetest - it was useful early in development, but isn't
	  really now.

Wed Jun 26 22:09:57 BST 2002  Olly Betts <olly@survex.com>

	* apitest: deldoc2 and deldoc3 now pass when the library is compiled
	  with --enable-debug.

Wed Jun 26 19:35:56 BST 2002  Olly Betts <olly@survex.com>

	* Removed code which causes quartztest to fail with an --enable-debug
	  build.

Wed Jun 26 13:55:11 BST 2002  Olly Betts <olly@survex.com>

	* todo.xml: added note to fix 100% being in its own sort band.

Wed Jun 26 13:46:02 BST 2002  Richard Boulton <richard@tartarus.org>

	* btree.cc: Fix splitting of blocks in sequential mode to ensure
	  that split happens no earlier than the midpoint.

Wed Jun 26 12:32:47 BST 2002  Richard Boulton <richard@tartarus.org>

	* btree.cc: Asserts to check that add_item in sequential mode
	  when splitting a block is not trying to add to the wrong block,
	  or to add to a new block which is not empty (or containing more
	  than one item).

Tue Jun 25 17:53:19 BST 2002  Olly Betts <olly@survex.com>

	* Assert that the value of c is sane in GETINT1, etc.

Tue Jun 25 16:30:09 BST 2002  Olly Betts <olly@survex.com>

	* btreetest.cc: use C++ IO rather than C stdio; removed commented out
	  LFSinsertdelete1 test (it was never written and a test suite which
	  creates 2G files is probably a bit too resource hungry).

Tue Jun 25 13:56:01 BST 2002  Olly Betts <olly@survex.com>

	* btree/quartz: More use of const pointers; more use of C++ strings.

Wed Jun 19 08:56:00 BST 2002  Sam Liddicott <sam@ananova.com>

	* Fixed spec file to build for prefix=/usr not just install there

Fri Jun 14 16:35:04 BST 2002  Olly Betts <olly@survex.com>

	* docs/todo.xml: added 4 new tasks.

Fri Jun 14 16:33:08 BST 2002  Olly Betts <olly@survex.com>

	* backends/quartz/quartz_database.cc: Cosmetic changes.

Wed Jun 12 16:31:11 BST 2002  Olly Betts <olly@survex.com>

	* QuartzDbKey, QuartzDbTag: just use a string instead of a string
	  wrapped in a structure.  We've stopped inflicting this on external
	  developers (OmData, OmKey/OmValue) so why inflict it on ourselves?

Wed Jun 12 12:26:04 BST 2002  Olly Betts <olly@survex.com>

	* Btree_item: use C++ strings rather than trying to reimplement them.

	* Fix a few warnings about unused parameters.

Wed Jun 12 02:53:16 BST 2002  Olly Betts <olly@survex.com>

	* Btree_full_compaction, Btree_close: removed - they just wrap methods
	  of Btree.

Wed Jun 12 02:28:30 BST 2002  Olly Betts <olly@survex.com>

	* Btree_item_create and Btree_item_lose subsumed into Btree_item
	  and ~Btree_item.

	* Pass C++ strings rather than const char * into various Btree open
	  methods.

	* Removed pointless wrapper functions for Btree open methods.

	* Btree_quit removed (just use delete directly).

	* Btree_create removed (just use Btree::create directly).

Wed Jun 12 00:48:52 BST 2002  Olly Betts <olly@survex.com>

	* form_key is now a method of Btree; more passing of strings rather
	  than pointer/length pairs); buffer overrun check added to btreetest.

Tue Jun 11 18:04:08 BST 2002  Olly Betts <olly@survex.com>

	* More C++ like interfaces (e.g. bool returns, strings rather than
	  pointer/length pairs).

Tue Jun 11 16:40:08 BST 2002  Richard Boulton <richard@tartarus.org>

	* quartz/btree.cc: Fix so that it compiles when BTREE_FULL_DEBUG is on,
	  and added a couple of Assert()s.

Tue Jun 11 13:09:39 BST 2002  Olly Betts <olly@survex.com>

	* Removed a number of btree functions which were simply wrappers for
	  calling methods on their first parameter, and most of which weren't
	  even used!

	* btree_api.txt: updated to better reflect the object-ized API.

Tue Jun 11 02:01:53 BST 2002  Olly Betts <olly@survex.com>

	* Btree::make_index_item(): Added check for buffer overflow.

Tue Jun 11 01:49:51 BST 2002  Olly Betts <olly@survex.com>

	* Still more...

Tue Jun 11 01:08:03 BST 2002  Olly Betts <olly@survex.com>

	* More btree and quartz tidying.

Mon Jun 10 20:33:24 BST 2002  Olly Betts <olly@survex.com>

	* btree.cc,btree.h: cleaned up further.

Mon Jun 10 15:54:49 BST 2002  Olly Betts <olly@survex.com>

	* Further btree and quartz cleanups.

Mon Jun 10 14:46:00 BST 2002  Olly Betts <olly@survex.com>

	* Fixed typo in recent quartzdump change.

Mon Jun 10 13:20:20 BST 2002  Olly Betts <olly@survex.com>

	* Quartz clean-ups - especially QuartzTermList.

Mon Jun 10 12:18:40 BST 2002  Olly Betts <olly@survex.com>

	* Bcursor_create made a method of class Btree as suggested by a FIXME.

Mon Jun 10 01:57:53 BST 2002  Olly Betts <olly@survex.com>

	* More btree fixes and tidying.  Fixed bug introduced by typo in
	  previous change which causes tests to fail.

Sun Jun 09 17:50:28 BST 2002  Olly Betts <olly@survex.com>

	* btree_util.h: use inlines rather than macros.

	* Fix CompileTimeAssert() to avoid potential clashes.

Sun Jun 09 12:46:25 BST 2002  Olly Betts <olly@survex.com>

	* btree.cc,btree.h: fixed bug caused by local variable masking member
	  variable with same name.  Tidied up a lot.

Wed Jun  5 12:22:57 BST 2002  Sam Liddicott <sam@ananova.com>

	* Fix OmQuery::op enum handling.

Mon May 27 14:28:06 BST 2002  Sam Liddicott <sam@ananova.com>

	* Add crash-protected next() to OmMSetIterator

	* Add ->valid() method to iterator which returns FALSE if
	  the iterator has reached the end

	* Added namespace fixes for latest cvs swig to be released next month

Fri May 24 15:28:18 BST 2002  Sam Liddicott <sam@ananova.com>

	* Took out the string typemaps as swig now has them in stl.i

	* Added om_percent to omtypes.i - I wonder if we might just
	  read omtypes.h instead, as swig can

	* Added OmMSetIterator and made changes to OmMSet

Fri May 24 11:46:50 BST 2002  Sam Liddicott <sam@ananova.com>

	* Now support get_matching_terms via swig
	  I'm not sure how to generally map iterators to php but in
	  cases where we know only a small number of items exist
	  to be iterated over it makes sense to return them as a 
	  php array

Tue May 21 15:28:40 BST 2002  Richard Boulton <richard@tartarus.org>

	* multi_postlist.cc (get_doclength):  Get the document length from
	  the appropriate sub-postlist, rather than from the database.
	  This causes a huge speedup in some cases, since it avoids having
	  to go to the termlist database for every document considered for
	  an mset to get the document length.
	  Added an AssertParanoid to check that the value from the postlist
	  is the same as that from the database.
	  This problem was noticed because "delve -v" was running several
	  orders of magnitude slower than without -v - it is now of
	  comparable speed.

Tue May 21 15:27:37 BST 2002  Richard Boulton <richard@tartarus.org>

	* quartz_values.cc: Small fixes to enable it to compile with debug
	  turned on.

Fri May 17 14:52:45 BST 2002  Olly Betts <olly@survex.com>

	* OmQueryParser::set_database() method added.

	* Added disabled code to search for a keyword used in the query.

	* Added ' and * to the list of "phrase making characters".

	* To make a phrase, a phrase-maker must be followed by an alphanumeric
	  rather than just a non-space.

Fri May 17 14:49:54 BST 2002  Olly Betts <olly@survex.com>

	* INSTALL: GCC 3.1 release version works, so noted this.

	* HACKING: Added note about warning-free compilation being desirable
	  and suggesting using "./configure CFLAGS=-Werror" to promote this.

	* NEWS: Minor updates.

Thu May 16 16:57:42 BST 2002  Olly Betts <olly@survex.com>

	* Minor tweaks to get a warning-less compile with GCC 3.1.

Thu May 16 13:36:19 BST 2002  Sam Liddicott <sam@ananova.com>

	* Clean up the spec file

Thu May 16 12:20:09 BST 2002  Olly Betts <olly@survex.com>

	* Documented match_sort_key.

Thu May 16 10:42:47 BST 2002  Sam Liddicott <sam@ananova.com>

	* A few quick tips from Olly, now the tarfile name and version no.
	  stuff comes from autoconf so the spec file won't need tweaking
	  each time the version number changes

Wed May 15 15:48:42 BST 2002  Sam Liddicott <sam@ananova.com>

	* This can build RPM packages.
	  Get the make-dist tarball and do:
	  rpm -ta xapian-core-0.4.1-cvs.tar.gz
	  and it will make source and binary rpms
	  It doesn't build bindings packages yet but this will come when I
	  build them

Wed May 15 13:27:21 BST 2002  Richard Boulton <richard@tartarus.org>

	* buildall: Allow use of automake 1.6.1 and later, and CVS
	  automake (versions 1.6[a-z])

Wed May 15 11:40:58 BST 2002  Sam Liddicott <sam@ananova.com>

	* SWIG cvs (php4) now writes all output files to the same directory as
	  the main output file, so need for hacks to move these, also no more
	  clobbering our source files when building in the checkout dir

Tue May 14 21:54:02 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Updated PLATFORMS file.

Tue May 14 16:48:07 BST 2002  Olly Betts <olly@survex.com>

	* Removed multiple-include protection from config.h - if it's
	  included more than once it's now a bug and we want to know!

Tue May 14 15:25:05 BST 2002  Olly Betts <olly@survex.com>

	* OmQueryParser: parse acronyms as a single term (so "E.T." -> "ET"
	  and "N.A.T.O" -> "NATO").

Tue May 14 15:23:20 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed config.h includes: source definition (ie not header) files
	  #include <config.h> as their first action.

Tue May 14 14:47:00 BST 2002  Olly Betts <olly@survex.com>

	* Updated todo.

	* extra/parsequery.yy: Fettled indentation.

Tue May 14 13:14:51 BST 2002  Olly Betts <olly@survex.com>

	* Added test case for new "embedded &" rule, and fix problem bug it
	  revealed.

Tue May 14 13:10:33 BST 2002  Olly Betts <olly@survex.com>

	* OmQueryParser: Parse <word>&<word> as a single term (e.g. AT&T,
	  M&S, A&P).

Tue May 14 11:50:03 BST 2002  Olly Betts <olly@survex.com>

	* When including config.h, always specify it as <config.h>, not
	  "config.h", and always do it first.  Both are recommended by
	  the autoconf documentation.

Mon May 13 17:17:13 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* missing fallback rule all-local in docs/Makefile.am was failing
	  the build on Solaris

Mon May 13 15:50:31 BST 2002  Sam Liddicott <sam@ananova.com>

	* Use new %extends notation for swig.

	* Update for new omValue usage

	* Add omqueryparser support

Mon May 13 15:12:30 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* shipped getopt will now build in absence of system getopt

Mon May 13 15:09:17 BST 2002  Olly Betts <olly@survex.com>

	* configure.in: Moved AH_TOP/AH_BOTTOM to more logical place.

	* docs/todo.xml: Updated.

Mon May 13 14:13:27 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* added getopt to DIST_SUBDIRS so distributions work

Fri May 10 14:54:06 BST 2002  Olly Betts <olly@survex.com>

	* getopt/: Checked in files I missed last time.

Fri May 10 14:35:52 BST 2002  Olly Betts <olly@survex.com>

	* Make sure GNU getopt is linked to everything which might need it so
	  we build in non-glibc environments.

Fri May 10 13:42:59 BST 2002  Olly Betts <olly@survex.com>

	* Replaced second match_sort_key optimisation with one which is
	  faster and not flawed.

Thu May 09 18:27:30 BST 2002  Olly Betts <olly@survex.com>

	* match_sort_key now runs at a sensible speed (approx. 20x speed
	  up on my test case).

Thu May 09 16:58:11 BST 2002  Olly Betts <olly@survex.com>

	* Added another optimisation for match_sort_key - my test case
	  is now 25% faster (still slow though).

Thu May 09 11:57:59 BST 2002  Olly Betts <olly@survex.com>

	* NEWS, PLATFORMS, README: Updated to something approximating what we
	  want for a release.

	* docs/todo.xml: Updated.

Thu May 09 10:57:59 BST 2002  Olly Betts <olly@survex.com>

	* Removed references to match_max_or_terms (which was replaced
	  by OmQuery::OP_ELITE_SET long, long ago).

Wed May 08 17:38:50 BST 2002  Olly Betts <olly@survex.com>

	* Improved api documentation comments.

Wed May 08 17:09:14 BST 2002  Olly Betts <olly@survex.com>

	* Include findheaders.pl in tarball.

Wed May 08 16:09:14 BST 2002  Olly Betts <olly@survex.com>

	* Killed off acconfig.h.

Wed May 08 15:53:11 BST 2002  Olly Betts <olly@survex.com>

	* Added autom4te-*.cache to .cvsignore.

Wed May 08 15:50:56 BST 2002  Olly Betts <olly@survex.com>

	* Rebuild docs on "make", not just "make dist" or "make install".

Wed May 08 15:07:01 BST 2002  Olly Betts <olly@survex.com>

	* Added workaround for problems with <fcntl.h> on Solaris when LFS
	  is enabled.

Wed May 08 13:44:10 BST 2002  Olly Betts <olly@survex.com>

	* Matcher can now sort on a key.  Can be rather slow at present...

Wed May 08 13:15:21 BST 2002  Olly Betts <olly@survex.com>

	* Updated todo.

Wed May 08 12:22:53 BST 2002  Olly Betts <olly@survex.com>

	* Removed ltmain.sh-s from CVS.

Wed May 08 12:21:32 BST 2002  Olly Betts <olly@survex.com>

	* buildall: run libtoolize; stripped out unnecessary stuff.

Wed May 08 09:44:45 BST 2002  Olly Betts <olly@survex.com>

	* matcher/msetpostlist.cc: Removed bogus comment cut and pasted from
	  matcher/mergepostlist.cc.

Tue May 07 17:51:57 BST 2002  Olly Betts <olly@survex.com>

	* It's "m4_include", not "m4include".

Tue May 07 17:52:36 BST 2002  Olly Betts <olly@survex.com>

	* Added autoconf/type_socklen_t macro.

Tue May 07 16:50:20 BST 2002  Olly Betts <olly@survex.com>

	* Now require autoconf 2.50, which allows us to clean up some of the
	  more unpleasant parts of the build system.

Tue May 07 14:55:37 BST 2002  Olly Betts <olly@survex.com>

	* Added "match_sort_bands" option to sort results within relevance
	  bands.  Currently the sort within each band is by document id, which
	  isn't really very useful.  The plan is to allow sorting by a key.

Tue May 07 14:54:12 BST 2002  Olly Betts <olly@survex.com>

	* Sorted out tests/findheaders.pl wrt last change.

Tue May 07 13:12:23 BST 2002  Olly Betts <olly@survex.com>

	* Run perl scripts from Makefiles explicitly with $(PERL) rather than
	  having them as generated files in AC_OUTPUT.

Mon May  6 16:04:37 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Distribution fixes: make clean should now clear up all
	  required files.

Mon May  6 14:42:46 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Don't include dlfcn.h since we don't use it (and doesn't exist
	  on some target platforms).

Mon May  6 14:07:24 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Minor documentation corrections.

Fri May 03 18:14:14 BST 2002  Olly Betts <olly@survex.com>

	* Changed autoconf/automake project name to xapian-core, and updated
	  the documentation to reflect this.

	* Disabled the bindings from being included in distribution tarballs.

Fri May 03 18:13:43 BST 2002  Olly Betts <olly@survex.com>

	* Updated todo list.

Fri May  3 18:02:06 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Overloading ambiguity resolutions for linux/alpha build on CF

Fri May 03 17:13:36 BST 2002  Olly Betts <olly@survex.com>

	* buildall: Don't run configure or make; removed --no-make and --quiet.

Fri May  3 16:52:01 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* tests/testdata/etext.txt needs to be included in the distribution

Fri May 03 16:18:38 BST 2002  Olly Betts <olly@survex.com>

	* Removed OmValue in favour of simply using a string (analogous to
	  recent OmData change).

Fri May 03 14:52:04 BST 2002  Olly Betts <olly@survex.com>

	* Removed unused om_docname typedef.

Fri May 03 14:42:31 BST 2002  Olly Betts <olly@survex.com>

	* Terminology change - a "key" (in the OmKey sense) is now a "value".

Fri May  3 14:31:57 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed up todo list and HTML generation script to cope with
	  items without an assigned priority.

Fri May 03 14:29:58 BST 2002  Olly Betts <olly@survex.com>

	* It's HACKING (not INSTALL) that has details of developer tools.

Thu May 02 15:57:48 BST 2002  Olly Betts <olly@survex.com>

	* Removed OmData - just return and take a string instead.

Thu May 02 14:40:21 BST 2002  Olly Betts <olly@survex.com>

	* docs/.cvsignore: updated.

Thu May 02 14:38:36 BST 2002  Olly Betts <olly@survex.com>

	* Removed assorted references to pthread locking; updated HACKING.

Thu May 02 14:15:47 BST 2002  Olly Betts <olly@survex.com>

	* Stripped out OmBatchEnquire stuff, as it's unlikely to get sorted
	  out any time soon, and it can be extracted from CVS when someone
	  wants it.

Thu May 02 13:50:04 BST 2002  Olly Betts <olly@survex.com>

	* Check for bison >= 1.35 in buildall.

Wed May 01 17:39:57 BST 2002  Olly Betts <olly@survex.com>

	* Removed lingering references to Omsee and OpenMuscat.

Wed May 01 16:34:13 BST 2002  Olly Betts <olly@survex.com>

	* Removed unused methods from NetClient (read_data and write_data).

Wed May 01 14:01:12 BST 2002  Olly Betts <olly@survex.com>

	* Added test consistency1 to check matcher optimisations don't
	  result in inconsistent results (i.e. that same matches and
	  weights are returned regardless of size of mset asked for).

Wed May 01 11:48:10 BST 2002  Olly Betts <olly@survex.com>

	* Fixed mismatched tags in todo.xml.

Wed May 01 11:46:42 BST 2002  Olly Betts <olly@survex.com>

	* Updated todo.

Wed May 01 11:40:47 BST 2002  Olly Betts <olly@survex.com>

	* Corrected configure warning message - it's XML::Parser not XML.

Wed May 01 11:34:49 BST 2002  Olly Betts <olly@survex.com>

	* Tweaks to get queryparser building cleanly.

Tue Apr 30 17:44:48 BST 2002  Olly Betts <olly@survex.com>

	* Updated query parser in extra from the updated one in omega,
	  and fettled it to cope better with multiple instantiations
	  (though it's a long way from being reentrant at the moment).

Tue Apr 30 11:03:44 BST 2002  Olly Betts <olly@survex.com>

	* Updated todo.

Mon Apr 29 19:28:04 BST 2002  Olly Betts <olly@survex.com>

	* More string.c_str() tidying.

Mon Apr 29 17:41:33 BST 2002  Olly Betts <olly@survex.com>

	* Tidied up some uses of string.c_str().

	* Cleaned up todo list.

Mon Apr 29 16:08:21 BST 2002  Olly Betts <olly@survex.com>

	* Updated buildall to check various tools have the required version
	  numbers.

Mon Apr 29 15:58:57 BST 2002  Olly Betts <olly@survex.com>

	* Tweaked use of HAVE_STREAMBUF

Fri Apr 26 14:41:09 BST 2002  Sam Liddicott <sam@ananova.com>

	* Swig is now modified so it can build config.m4 and Makefile.in
	  for php modules so I removed these from bindings/php4

Tue Apr 23 18:21:03 BST 2002  Olly Betts <olly@survex.com>

	* Tried compiling with GCC 3.1 prerelease snapshot and fixed various
	  STL-related warnings (mostly uses of istrstream).

	* Fixed usage of AM_CFLAGS and AM_CXXFLAGS.

Tue Apr 23 15:48:36 BST 2002  Olly Betts <olly@survex.com>

	* Updated buildall (and had to tweak it again, sigh).

Tue Apr 23 14:21:01 BST 2002  Sam Liddicott <sam@ananova.com>

	* Added typemap conversion to generate OmSettings from php hash
	* Changed order of classes in interface file

Tue Apr 23 14:20:05 BST 2002  Olly Betts <olly@survex.com>

	* Revamped xapian-config and xapian.m4.  Important change - it's now
	  "xapian-config --cxxflags" and XAPIAN_CXXFLAGS, not --cflags and
	  _CFLAGS.

Mon Apr 22 17:58:56 BST 2002  Olly Betts <olly@survex.com>

	* Removed leak checker.

Mon Apr 22 13:40:01 BST 2002  Olly Betts <olly@survex.com>

	* Tiny code tweak.

Mon Apr 22 13:11:32 BST 2002  Olly Betts <olly@survex.com>

	* Write debug log using unbuffered IO and O_APPEND which should prevent
	  the log file becoming garbled when used from applications which use
	  Xapian objects in multiple threads.

Mon Apr 22 12:19:18 BST 2002  Olly Betts <olly@survex.com>

	* Updated copyright notices for last change.

Mon Apr 22 11:20:28 BST 2002  Olly Betts <olly@survex.com>

	* Removed thread locks.

Fri Apr 19 17:38:23 BST 2002  Olly Betts <olly@survex.com>

	* Removed completed tasks from todo list.

Fri Apr 19 17:26:23 BST 2002  Olly Betts <olly@survex.com>

	* Removed placeholder code for OmQuery::OP_PERCENT_CUTOFF - it's
	  actually impossible to implement since we started rescaling
	  percentages so that 100% is attainable.

Fri Apr 19 16:42:42 BST 2002  Olly Betts <olly@survex.com>

	* Tracked down and fixed the bug in the quartz backend which was making
	  test poslist2 fail.

Fri Apr 19 16:06:39 BST 2002  Olly Betts <olly@survex.com>

	* Fixed some compilation problems which I somehow failed to notice
	  before the last check-in.

Fri Apr 19 15:04:13 BST 2002  Olly Betts <olly@survex.com>

	* Added more RETURN(...) wrappers.

Fri Apr 19 14:46:19 BST 2002  Olly Betts <olly@survex.com>

	* Added more DEBUGCALL tracing to quartz.

Fri Apr 19 13:29:57 BST 2002  Olly Betts <olly@survex.com>

	* Minor tweaks to quartz_database.cc.

Fri Apr 19 13:07:50 BST 2002  Olly Betts <olly@survex.com>

	* Moved test poslist1 into correct place and renamed it to poslist2
	  since there's already a poslist1...

Fri Apr 19 11:19:15 BST 2002  Olly Betts <olly@survex.com>

	* poslist1 (when actually run!) reveals that Quartz fails to throw
	  errors in this case.  Disabled test for now, as I can't see why it
	  fails to throw...

Thu Apr 18 17:44:56 BST 2002  Olly Betts <olly@survex.com>

	* Added poslist1 test as suggested by a TODO entry.

Thu Apr 18 14:17:24 BST 2002  Olly Betts <olly@survex.com>

	* buildall: Removed search for GNU make (as of automake
	  1.5 it's not needed for automake and we aim to have portable
	  makefiles).  Made buildall more portable.

Thu Apr 18 14:16:18 BST 2002  Olly Betts <olly@survex.com>

	* xapian-config.nodep is a generated file, so don't look for it in
	  srcdir.

Thu Apr 18 12:45:04 BST 2002  Olly Betts <olly@survex.com>

	* Added bindings/php4/xapian/.cvsignore.

Thu Apr 18 12:36:53 BST 2002  Olly Betts <olly@survex.com>

	* Minor tweaks to "Makefile" section in HACKING.

Thu Apr 18 12:26:21 BST 2002  Olly Betts <olly@survex.com>

	* Yet more Makefile portability fixes; added section to HACKING
	  summarising my recent experiences.

Thu Apr 18 11:26:37 BST 2002  Olly Betts <olly@survex.com>

	* Corrected the sense of the test in the previous check-in.

Thu Apr 18 11:08:04 BST 2002  Olly Betts <olly@survex.com>

	* Use case instead of echo/sed to replace dirname.

Thu Apr 18 10:19:01 BST 2002  Olly Betts <olly@survex.com>

	* Another Makefile portability tweak.

Wed Apr 17 16:07:02 BST 2002  Olly Betts <olly@survex.com>

	* bindings/php4/Makefile.am: Fixed a couple of problems with
	  recent changes.

Wed Apr 17 15:32:44 BST 2002  Olly Betts <olly@survex.com>

	* Makefile portability improvements.

Wed Apr 17 14:29:21 BST 2002  Olly Betts <olly@survex.com>

	* Replaced uses of GNU make specific features with more portable
	  ones.

Wed Apr 17 12:43:07 BST 2002  Olly Betts <olly@survex.com>

	* Update todo list.

Wed Apr 17 12:41:03 BST 2002  Olly Betts <olly@survex.com>

	* Removed BrightStation's logo from the documentation.

Wed Apr 17 12:27:07 BST 2002  Olly Betts <olly@survex.com>

	* xapian-config: Removed --uninst support - it's very hard to make it
	  work reliably and we're better off directing our efforts towards
	  improving the library than trying to get it working and keep it
	  working.

Wed Apr 17 10:39:02 BST 2002  Olly Betts <olly@survex.com>

	* Fixed btreetest code to use new names "ord+" and "ord-" for
	  datafiles; disabled LFSinsertdelete1 test as it's exactly the
	  same as insertdelete1 (despite the comment above which suggests
	  it tests files >2G).

Mon Apr 15 17:14:22 BST 2002  Olly Betts <olly@survex.com>

	* Fix a few OmDatabase::InternalInterface uses I'd somehow missed.

Mon Apr 15 16:08:20 BST 2002  Olly Betts <olly@survex.com>

	* Mark internal classes as @internal for doxygen; removed all uses
	  of OmDatabase::InternalInterface as it's no longer needed.

Mon Apr 15 15:42:47 BST 2002  Olly Betts <olly@survex.com>

	* Updated TODO list.

Mon Apr 15 2002  Sam Liddicott <sam@ananova.com>

	* Hacked around bindings and bindings/php to remove some SWIG
	  workarounds.  SWIG cvs + some new non-comitted patches is need still.

Mon Apr 15 12:12:05 BST 2002  Olly Betts <olly@survex.com>

	* stemtest: getopt fix.

	* stemtest.pl.in: output now: less verbose by default and coloured.

Mon Apr 15 11:18:58 BST 2002  Olly Betts <olly@survex.com>

	* Updated HACKING to say that automake 1.5 is required, and note that
	  automake 1.6.1 is better than 1.6.

Sat Apr 13 20:35:51 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed stemtest getopt usage so it works again.

Sat Apr 13 20:20:52 BST 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Fixed omtcpsrv getopt usage so it works again.

Fri Apr 12 16:24:06 BST 2002  Olly Betts <olly@survex.com>

	* Require automake 1.5.

Fri Apr 12 12:11:57 BST 2002  Olly Betts <olly@survex.com>

	* omtcpsrv: Namespace fixes.

Fri Apr 12 12:25:42 BST 2002  Olly Betts <olly@survex.com>

	* Fixed everything to use getopt rather than icky handparsing of
	  options.

Fri Apr 12 11:26:57 BST 2002  Olly Betts <olly@survex.com>

	* Removed delve - it's going to be an example program.

Thu Apr 11 18:09:35 BST 2002  Olly Betts <olly@survex.com>

	* Command line argument improvements - added FIXMEs where getopt
	  should be used.

Thu Apr 11 17:01:44 BST 2002  Richard Boulton <richard@tartarus.org>

	* Fixes to work with automake 1.6.1.
	  I recommend using 1.6.1 rather than 1.6, since this fixes many
	  bugs in 1.6.  I havn't tested with 1.6 recently, but it is likely
	  to report problems.

Thu Apr 11 17:25:37 BST 2002  Olly Betts <olly@survex.com>

	* Use GNU getopt.

Thu Apr 11 15:06:15 BST 2002  Olly Betts <olly@survex.com>

	* Updated to recommend automake 1.5, noting problem with automake 1.4
	  and that we'll probably soon insist on 1.5, and later autoconf 2.50.
	  Also added notes on recommended and usable GCC versions.

Thu Apr 11 14:23:44 BST 2002  Olly Betts <olly@survex.com>

	* Cleaning up build system.

Thu Apr 11 13:18:23 BST 2002  Olly Betts <olly@survex.com>

	* Use AndPostList with boolean weights on the RHS instead of
	  FilterPostList - this appears to fix a bug, but I suspect it's
	  actually just moving it around.  Will investigate later.

Thu Apr 11 10:11:11 BST 2002  Olly Betts <olly@survex.com>

	* Sorted out automake for php4 bindings.

Wed Apr 10 14:44:50 BST 2002  Olly Betts <olly@survex.com>

	* Removed a superfluous DEBUGLINE.

Tue Apr  9 19:02:09 BST 2002  Richard Boulton <richard@tartarus.org>

	* Fix some DEBUGLINE() macros in the matcher which had
	  the first parameter missing.

Tue Apr 09 17:50:44 BST 2002  Olly Betts <olly@survex.com>

	* Removed stray bit of debug code.

Tue Apr 09 17:05:09 BST 2002  Olly Betts <olly@survex.com>

	* More debug tracing added.

Tue Apr 09 10:48:42 BST 2002  Olly Betts <olly@survex.com>

	* Disabled pthread support by default.

Sat Apr  6 20:45:21 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Reordered some output generation in configure so it won't
	  complain about directories not existing. (I don't understand
	  what the problem is, but this does fix it.)

Sat Apr 06 20:27:57 BST 2002  Olly Betts <olly@survex.com>

	* Moved a few lingering traces of XML indexer stuff to indexer
	  subdirectory.

Sat Apr 06 17:37:02 BST 2002  Olly Betts <olly@survex.com>

	* Removed -pedantic (read the gcc docs - it's doesn't turn on
	  useful warnings) and fixed all the remaining compilation
	  warnings in a non-debug build.

Fri Apr 05 10:21:28 BST 2002  Olly Betts <olly@survex.com>

	* Removed --enable-profiling, --enable-purify, and --enable-insure.
	  They don't do anything which can't be achieved by passing
	  environment variables and switches to configure (now documented
	  in HACKING).  Adding a separate switch for every profiling and
	  code-quality tool out there isn't a sensible approach.

Thu Apr 04 20:37:12 BST 2002  Olly Betts <olly@survex.com>

	* Updated .cvsignore files.

Thu Apr 04 20:25:41 BST 2002  Olly Betts <olly@survex.com>

	* PTHREAD_CFLAGS was only being used for compiling C, not C++, which
	  was causing builds to fail unless threading was disabled.  This
	  problem has been there a long time, but until recently was hidden
	  by the check for fdatasync erroneously linking in -lrt which pulls
	  in pthreads anyway (at least this is the situation on Linux).

Thu Apr 04 20:06:00 BST 2002  Olly Betts <olly@survex.com>

	* Removed XML indexer stuff from the main xapian library.  All the
	  removed bits are now in the indexer subdirectory, ready to be
	  reassembled into a supplementary library.

Thu Apr 04 15:43:43 BST 2002  Olly Betts <olly@survex.com>

	* More debug tracing in the matcher.

Thu Apr 04 14:17:10 BST 2002  Olly Betts <olly@survex.com>

	* Added debug tracing to most of the matcher.

Thu Mar 28 17:21:16 GMT 2002  Olly Betts <olly@survex.com>

	* Give up trying to make internals private or protected in the
	  header files in include - the consequences are just too ugly, and
	  it's clear enough that they shouldn't be messed with except by the
	  library itself.

Wed Mar 27 10:24:26 GMT 2002  Olly Betts <olly@survex.com>

	* Don't add "-lrt" to the link line unless it's actually needed for
	  fdatasync().

Wed Mar 27 10:11:09 GMT 2002  Olly Betts <olly@survex.com>

	* Fixed two problems in the matcher which were respectively causing
	  problems with boolean filters, and with situations where OR or
	  ANDMAYBE decayed to AND.

Fri Jan 11 18:00:44 GMT 2002  James Aylett  <tartarus@users.sourceforge.net>

	* Various build fixes for libxml2: define CHAR as needed,
	  --enable-validation (off by default), check for and discard
	  'blank' text/cdata nodes as we encounter them

Fri Jan 11 15:40:50 GMT 2002  Sam Liddicott <sam@ananova.com>

	* Added Large File Support in the same way it was added to GNU tar.
	  (If it's good enough for them...)
	  This is by means of autoconf/ac_sys_largefile which I'm told is
	  built in to later versions of autoconf, and may possibly give us
	  trouble redefining it for those versions...  But we'll see about
	  that when/if it happens.

	  It seems to work fine here on some DB's which I had to stop growing
	  cos they got too big; I'm now past the 2G boundry with no problems

	  I guess we should still add overflow detection for 2^31 blocks.
	  Ideas?

	  I need some help on the btreetest.cc as I haven't yet worked out
	  what it does; so while I've added a test, it doesn't yet test
	  what it says it does.  I have changed btreetest.cc so you can
	  tell it where to dump the test DB

Fri Dec 21 17:48:09 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed halflife calculation in OmBiasFunctor.

Fri Dec 21 15:24:58 GMT 2001  Olly Betts <olly@survex.com>

	* Added a temporary API to allow use of OmBiasFunctor.

Fri Dec 21 12:58:23 GMT 2001  Olly Betts <olly@survex.com>

	* Disable conversion of OR to AND/ANDMAYBE in matcher tree - there's
	  a bug which sometimes manifests when there's a date filter and a
	  threshold cutoff in omega, and results in just one match when there
	  should be more.  I don't believe the bug is actually in OrPostList
	  but I've been tracking it for 4 days without success and turning off
	  this optimisation seems to stop it occuring so will have to do for
	  now.

Thu Dec 20 17:41:04 GMT 2001  Olly Betts <olly@survex.com>

	* matcher/multimatch.cc: added more percent_cutoff assertions.

Thu Dec 20 13:41:41 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed incorrectly classified debug message; fixed compiler warning;
	  more comments about matches_* with a percent_cutoff.

Thu Dec 20 13:09:51 GMT 2001  Olly Betts <olly@survex.com>

	* Better OmPostListIterator::get_description() (call get_description
	  on internal->postlist).

Thu Dec 20 12:42:55 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed assorted problems with omtcpsrv and co from recent change.

Thu Dec 20 10:41:57 GMT 2001  Richard Boulton <richard@tartarus.org>

	* In ./configure --help, correctly report muscat36 backend as
	  defaulting to off.

Thu Dec 20 10:36:18 GMT 2001  Olly Betts <olly@survex.com>

	* Don't delete internal in ~OmWritableDatabase - ~OmDatabase
	  does that for us (internal was zeroed after delete, so this
	  was probably harmless)

	* Tweaked OmEnquire::get_description() and
	  OmPostListIterator::get_description() to do less - there's a
	  debug related bug somewhere and get_description() should be a
	  non-intrusive method...

Thu Dec 20 10:32:56 GMT 2001  Richard Boulton <richard@tartarus.org>

	* Fix a couple of misquoted messages in configure.in.

Tue Dec 18 23:22:00 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Use xapian.org where appropriate in documentation references

Tue Dec 18 14:32:32 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Use xapian.org not sourceforge for schemas

Mon Dec 17 18:47:08 GMT 2001  Olly Betts <olly@survex.com>

	* Cured problems with string('x') caused by overzealous search
	  and replace on my part.

Mon Dec 17 16:44:31 GMT 2001  Olly Betts <olly@survex.com>

	* Improved matches_estimated when a percent_cutoff is in effect.

Sun Dec 16 18:09:28 GMT 2001  Olly Betts <olly@survex.com>

	* You can now register a match decider functor by name with an
	  OmEnquire object.  It's not yet used for anything though.

Sun Dec 16 17:31:08 GMT 2001  Olly Betts <olly@survex.com>

	* omtcpsrv: simplified arguments - just list database directories and
	  they'll be opened with the auto backend.  Removed --im as it didn't
	  work as advertised and nobody's noticed (as actually implemented it
	  was useless).

Sat Dec 15 14:10:32 GMT 2001  Olly Betts <olly@survex.com>

	* Minor update to todo.xml.

Sat Dec 15 13:43:47 GMT 2001  Olly Betts <olly@survex.com>

	* More fettling of OmBiasFunctor stuff - still not ready for use yet...

Tue Dec 11 13:06:08 GMT 2001  Olly Betts <olly@survex.com>

	* Don't work out probabilistic weights for boolean bits of the query
	  (rhs of FILTER and AND_NOT) which fixes incorrect percentage weights
	  in filtered queries.

Tue Dec 11 12:26:44 GMT 2001  Olly Betts <olly@survex.com>

	* Added test singlesubq1 to keep an eye on can_replace_by_single_subq.

Mon Dec 10 16:58:21 GMT 2001  Olly Betts <olly@survex.com>

	* can_replace_by_single_subq shouldn't return true for OP_ELITE_SET
	  since you can't call set_elite_set_size() on an arbitrary subquery.

Thu Dec  6 15:02:05 GMT 2001  Richard Boulton <richard@tartarus.org>

	* (omqueryinternal.cc, omtermlistiteratorinternal.h)
	  Fix some compiler warnings (when compiling with no debug) due
	  to methods which should return a value but simply contain
	  "Assert(false);".  Throw an exception in such methods instead
	  (after the Assert).

Mon Dec 03 11:20:42 GMT 2001  Olly Betts <olly@survex.com>

	* New BiasPostList - not yet enabled as it needs more work.

Mon Dec 03 11:16:44 GMT 2001  Olly Betts <olly@survex.com>

	* quartzdump: give syntax error if no tables specified.

Thu Nov 29 14:10:43 GMT 2001  Olly Betts <olly@survex.com>

	* ExtraWeightPostlist wasn't handling prune correctly.

Thu Nov 22 13:46:59 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed segfault when percentage_cutoff emptied the proto-mset.

Thu Nov 22 12:27:49 GMT 2001  Olly Betts <olly@survex.com>

	* Enhanced test emptyquery1.

Fri Nov 16 15:32:09 GMT 2001  Olly Betts <olly@survex.com>

	* Added OmQuery::is_empty() method.

Thu Nov 15 15:36:07 GMT 2001  Olly Betts <olly@survex.com>

	* Updated todo list.

Thu Nov 15 13:03:05 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed percent_cutoff problems.

Wed Nov 14 12:05:44 GMT 2001  Olly Betts <olly@survex.com>

	* Empty OmQuery() now matches no documents (rather than causing an
	  exception).

Thu Nov 08 18:23:21 GMT 2001  Olly Betts <olly@survex.com>

	* SIGSTKFLT isn't portable, so added #ifdef checks for it.

Wed Nov 07 15:34:29 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed 2 GCC 3.0 warnings in muscat36 backend.

Wed Nov 07 14:21:47 GMT 2001  Olly Betts <olly@survex.com>

	* Made doc counts returned from percentage cutoff matches more
	  accurate.

Wed Nov 07 12:30:32 GMT 2001  Olly Betts <olly@survex.com>

	* GCC 3.0 fixes.

Tue Nov 06 11:16:42 GMT 2001  Olly Betts <olly@survex.com>

	* Matcher now calculates percentages like Omega does (or did as I'm
	  about to remove that code from Omega), rather than as a percentage
	  of the theoretical maximum possible weight.  The old way generally
	  gives disappointingly low values, and by pushing the percentage
	  code down into the matcher, it can be used to optimise the query.

Tue Nov 06 11:13:06 GMT 2001  Olly Betts <olly@survex.com>

	* Quick fix for problems with null OmQuery-s.

Mon Nov 05 15:52:55 GMT 2001  Olly Betts <olly@survex.com>

	* Added signal handling to testsuite - if a testcase generates a
	  signal it is caught and reported, then the testsuite continues
	  with further testcases.

Wed Oct 31 14:26:59 GMT 2001  Olly Betts <olly@survex.com>

	* Removed needless complications in matcher when a weight threshold
	  has been set.

Tue Oct 30 16:50:46 GMT 2001  Olly Betts <olly@survex.com>

	* Removed superfluous lines from configure.in; fixed warning from
	  automake 1.5.

Mon Oct 29 11:54:36 GMT 2001  Olly Betts <olly@survex.com>

	* Changed matcher to form proto-mset using a min-heap (as described
	  in "Managing Gigabytes", 2nd ed., pp 211-213).  Compared to the
	  previous "nth-element" approach, this uses about half the memory,
	  allows the min-weight based matcher optimisations to work sooner,
	  and should be inherently faster (not yet benchmarked though).  The
	  code's slightly simpler too.

Mon Oct 29 11:53:38 GMT 2001  Olly Betts <olly@survex.com>

	* Fixed remote backend to pass match_cutoff setting across.

Fri Oct 26 13:43:08 BST 2001  Olly Betts <olly@survex.com>

	* Reserve size needed for mset vector.

Thu Oct 25 18:00:54 BST 2001  Olly Betts <olly@survex.com>

	* Fixed a couple of stray references to the old sleepycat backend.

Tue Oct 23 18:19:32 BST 2001  Olly Betts <olly@survex.com>

	* More cleaning up of MultiMatch.

Tue Oct 23 16:14:27 BST 2001  Olly Betts <olly@survex.com>

	* Removed RemotePostList - it was an experimental idea which proved
	  to be too slow even on a fast network.  Cleaned up code where hooks
	  were bodged in for it.

Tue Oct 23 13:27:12 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Added documentation of the test system (albeit brief). Also
	  mentioned the autotools book in HACKING.

Tue Oct 23 12:07:59 BST 2001  Olly Betts <olly@survex.com>

	* Updated .cvsignore files.

Tue Oct 23 11:29:47 BST 2001  Olly Betts <olly@survex.com>

	* Code tidying while investigating sporadic fails from quartztest.

Mon Oct 22 17:42:30 BST 2001  Olly Betts <olly@survex.com>

	* Minor fettles to quartztest: fixed warnings, whitespace tidying,
	  use mkdir(...) rather than system("mkdir ...")

Mon Oct 22 16:41:12 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Renamed project to Xapian.

Mon Oct 22 14:22:00 BST 2001  Olly Betts <olly@survex.com>

	* Fixed non-ISO C++ code so Xapian will compile under GCC 3.0
	  (and also RedHat's "GCC 2.96").

Mon Oct 22 11:21:45 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Altered omseek-config and the AC m4 macro to make uninst
	  executables link to the right version of the library

Mon Oct 22 10:38:20 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Minor fixes to enable build (and test) under Solaris.

Fri Jun 22 13:24:59 2001  Sam Liddicott <sam@ananova.com>

	* Added some explicit type casts in xmlindexer and quartz backend
	  to help gcc2.96 compile.

Thu Jun 21 11:05:31 2001  James Aylett  <tartarus@users.sourceforge.net>

	* HACKING updated to (a) remove inaccurate statements about
	  copyright assignment, and (b) talk about developer write
	  access to CVS.

Mon Jun 11 13:24:43 2001  James Aylett  <tartarus@users.sourceforge.net>

	* pthread support detected using an automake macro. Should
	  be more portable as a result.

	* We need GNU make: buildall now tries to find it.

Mon Jun 11 12:07:00 2001  Hein Ragas <hragas@users.sourceforge.net>

	* Modified QuartzWritableDatabase::do_add_document and
	  QuartzWritableDatabase::do_replace_document to leave the PositionList
	  empty for a term with no positions associated with it.

Mon May 29 12:17:00 2001  Hein Ragas <hragas@users.sourceforge.net>

	* Modified QuartzPostList::add_entry to allow for adding of entries
	  in the middle of the postlist, not only at the end.

Mon May 28 12:00:00 2001  Hein Ragas <hragas@users.sourceforge.net>

	* Fixed a bug in replace_document for Quartz, added a test to
	  ensure proper working of the fix.

Fri Apr 27 15:16:10 2001  James Aylett  <tartarus@users.sourceforge.net>

	* Project name change to Omseek.

Wed Apr 11 09:06:37 BST 2001 Chris Emerson <chris.emerson@omsee.com>

	* Implemented deleting of items from postlists, and added some
	  tests to check that it works properly.

	* Fixed a potential memory leak in QuartzPostList if an exception
	  was thrown from the constructor.

	* BackendManager now sets the quartz_logfile setting, to make
	  the logs available from the testsuite.

	* Added mention of quartz_logfile to docs/omsettings

	* Removed a bad assert from InMemoryDatabase::get_doclength()

Mon Apr  9 21:48:18 BST 2001 Chris Emerson <chris.emerson@omsee.com>

	* Added #include <cmath> to testutils.cc

Fri Mar 30 17:37:24 BST 2001 Olly Betts

	* Added extra/.cvsignore

Fri Mar 30 17:22:13 BST 2001 Olly Betts

	* Disabled allocation checking of new[] and delete[] since some STL
	  implementations use them which leads to leaks being reported where
	  none exist.  This is addressable longer term...

Thu Mar 29 19:05:46 BST 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add "extra" directory to om source tree, to hold extra libraries
	  for use with omsee, which aren't part of the core.

	* Put a query parser into "extra".  This is roughly the parser
	  from omega.  Needs some work: in particular, it needs to be
	  made reentrant.

	* Added extra/ directory to top level Makefile.am and configure.in.
	  Added AC_PROG_YACC to Makefile.am

	* Add includes of required header files to omquery.h.

Wed Mar 28 17:15:22 BST 2001  Richard Boulton <richard.boulton@omsee.com>

	* Modifications to OmQuery.  Remove the isbool flag: there is
	  no longer any need for the concept of a "pure boolean query".
	  The same effect as was obtained by setting isbool can be
	  obtained by setting the match_weighting_scheme parameter to
	  bool.

	* Also, undefined queries may no longer be used when
	  building up composite queries; the correct behaviour for this
	  is hard to define and implement and harder to document, and
	  removing this removes lots of special case code.

	* Updated network query passing code.

	* Remove special cases for bool weighting in localmatch and irweight.

	* Updated omsettings docs.  Updated comments in omsetting.h.

	* Updated todo.xml

	* Incremented network protocol version.

	* Added test_emptyop1, which checks what happens when an attempt is
	  made to use an empty list of subqueries to build up a query, and
	  then use the query.

	* Remove test_boolsubq1: no such thing as a boolean query now, so
	  no need to test what happens when one is used.

	* Updated testsuite to use "match_weighting_scheme" setting, rather
	  than calling OmQuery::set_bool().

Wed Mar 28 15:05:46 BST 2001 Chris Emerson <chris.emerson@omsee.com>

	* Fixes to InMemoryDatabase:
	  do_open_post_list returns an EmptyPostList rather than an
		assertion error if the term doesn't exist
	  Fixed doccount(), which wasn't decrementing on delete_doc()
	  Remove terms from the database when they have no more postings.
	  Implement collection frequencies, and run collfreq tests for
		inmemory.

Wed Mar 28 14:24:38 BST 2001  Richard Boulton <richard.boulton@omsee.com>

	* Set elite set size to max(10, sqrt(number of subqueries)) by
	  default.  This is rather more useful than the old default of 0.

Wed Mar 28 10:25:35 BST 2001 Chris Emerson <chris.emerson@omsee.com>

	* QuartzDatabase now implements replace_document(), and
	  delete_document() now removes keys/attributes as well.
	  However, postlist entries are not yet correctly removed,
	  so this will cause problems.

	* Added a test for deleting/replacing documents, which passes.

Tue Mar 27 17:31:58 BST 2001 Chris Emerson <chris.emerson@omsee.com>

	* QuartzAttributes now has a method to delete a document's
	  attributes, and QuartzRecordManager has a replace_ method.
	  (But the code which uses these isn't in this commit).

Thu Mar 22 15:58:08 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Change definition of OmQuery::is_defined(), so that elite set
	  queries are undefined until a size is specified for the set.

Wed Mar 21 14:29:04 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Implemented delete_document and replace_document in inmemory
	  database.

Wed Mar 21 12:39:13 GMT 2001 Olly Betts

	* Tweak to docs/quickstart.html.

Wed Mar 21 02:50:19 GMT 2001 Olly Betts

	* Entirely removed sleepcat backend and all references to it.

	* Disable muscat36 backend by default.

Tue Mar 20 18:47:12 GMT 2001 Olly Betts

	* open_document() now takes a lazy flag - if not set we need to check
	  that the docid given actually exists.

	* heavy_duty flag now a bool instead of an int.

Mon Mar 19 19:16:34 GMT 2001 Olly Betts

	* Added test getdoc1 to check exceptions are thrown for out-of-range
	  docids (currently they aren't for quartz and muscat36 backends).

Mon Mar 19 17:17:31 GMT 2001 Olly Betts

	* New simpler implementation of leak detection in testsuite.
	  Currently doesn't support malloc/calloc/realloc/free.

Mon Mar 19 16:46:16 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Further small modification to omsee-config: will now look in
	  .libs subdirectories, too.

Mon Mar 19 15:57:18 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Update omsee-config to work when a prefix is specified that
	  points directly to the directory with the library, rather than
	  expecting the library to be in a subdir "libs/".  (libs/ is
	  still used if it exists).

	* Update omsee.m4, to use omsee-config even when using an
	  uninstalled version of omsee.  This in turn fixes problems using
	  uninstalled versions of omsee with STLport.

Fri Mar 16 18:14:52 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Updated licenses, to include year 2001.

Fri Mar 16 15:40:49 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Fix up small bug in quartztest causing it to fail for lack of an
	  expected exception.  Initialise values in quartz_positionlist.cc
	  when position list is not present.

Thu Mar 15 17:40:38 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Make timeout absolute, rather than cumulative, when fetching
	  multiple documents from database: if two nodes fail, the total
	  timeout should still be that specified, not twice it.

	* Make the timeout set by SocketClient::set_query() get reset
	  correctly if an exception happens (which used to prevent
	  SocketClient::get_mset() ever getting called).

Thu Mar 15 17:06:51 GMT 2001 Olly Betts

	* Oops, checked in too much - backing out the wrong stuff.

Thu Mar 15 16:30:14 GMT 2001 Olly Betts

	* Include autoconf/definedir.m4 in tarball.

Thu Mar 15 16:06:02 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Updated network protocol number to reflect change adding
	  OP_ELITE_SET.

Thu Mar 15 15:31:35 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* QuartzPositionList should no longer complain if positional
	  information isn't available for a particular term / document
	  combination.

	* Updated todo.

Thu Mar 15 13:55:53 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Removed OmDocument::set_wdf() and OmDocument::add_term().
	  Replaced with OmDocument::add_term_nopos(), which adds a term
	  without specifying positional information, taking an optional
	  wdfinc parameter.  Updated testsuite correspondingly.

Thu Mar 15 13:14:10 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Update TODO

Wed Mar 14 17:51:40 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Added new operator OP_ELITE_SET, which replaces match_max_or_terms
	  option.  Can now specify exactly which terms to apply max_or_terms
	  to.  max_or_terms is obselete: an error will be thrown if an
	  attempt is made to use it.

Wed Mar 14 15:56:20 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Added test for and implementation of multiple XOR queries.

	* Fix small bugs with get_termfreq_est() for xor and andnot
	  postlists.

Mon Mar  5 16:08:01 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Catch exceptions within the loop in SocketServer - exceptions
	  should normally not kill the server.  This means that that a
	  client still works after eg an OmDocNotFoundError, which was
	  causing problems before.

Fri Mar  2 18:15:47 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add a new query operator, OP_WEIGHT_CUTOFF, which returns only
	  those documents from a query which have a weight greater than a
	  specified cutoff value.  Also added OP_PERCENT_CUTOFF, but this
	  is not yet implemented.

	* Added test of new cutoff function, cutoff2.

	* Updated network protocol to pass new queries.  Increased protocol
	  version number (to 10).

	* Added set_cutoff() function to OmQuery, to set cutoff parameter.

	* Updated TODO.

	* Remove unused member "PostList * postlist" of LocalSubMatch.

Thu Mar  1 12:04:53 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Updates to HACKING.

Wed Feb 28 18:42:47 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Fixes to neaten up configure output, and to test for the Perl
	  Text::Format module, thanks to James Aylett (patch slightly
	  modified, so if it doesn't work it's probably my fault).

	* configure.in checks for presence of ftime() and gettimeofday()

	* Added OmTime, a class to deal with times to an accuracy of
	  microseconds, or whatever the best accuracy the system supports
	  is.

	* Use OmTime in network code instead of time(NULL).

Wed Feb 28 14:23:11 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Merge common code from OmSocketLineBuf::wait_for_data() and
	  OmSocketLineBuf::do_readline() into
	  OmSocketLineBuf::attempt_to_read(), and thus fix bug in
	  wait_for_data() when 0 bytes returned from read().

Tue Feb 27 18:40:33 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Fixes to remote matcher code to cope better with failure of
	  submatchers:
	  - Timeout for all submatches now correctly start at same time.

	* Added more extensive testing of above code, involving adding
	  new parameters to inmemory to cause abort()s at various stages of
	  the match.

	* Remove obselete (and unused) method
	  SocketServer::read_global_stats()

	* Errors are now generated from strings by using omerrortypes.h with
	  suitable #defines before including it.  Updated todo accordingly.

	* Extend scope of try{} clause in socketserver, so that
	  SocketServerFinished exception never escapes.

	* Default timeout in progserver increased to 30000.

	* Default timeout in tcpserver increased to 15000.

Mon Feb 26 23:51:23 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Split query generation into stages: make new query, add subqueries,
	  then finalise.  Add private methods to OmQuery reflecting this, and
	  convert constructors into template methods, allowing any iterator
	  to be used for constructing queries.  Removed reference to
	  <vector> from omquery.h

	* Add omqueryinternal.cc, containing implementation of query
	  internals. (surprise!)

	* OmQuery::Internal now has some helper functions to determine the
	  properties of each particular query.  These should be converted
	  into a lookup table, and the remaining hard-coded properties (for
	  AND_MAYBE, AND_NOT and FILTER) factored out.

	* window property removed from constructor.  This can now be set by a
	  separate call, to "OmQuery::set_window()"

	* Added a deleter_vector class, to store subquery pointers in a more
	  exception-safe way.

	* Represent undefined queries by the new OP_UNDEF operation, rather
	  than a dedicated flag - cleaned up some logic.

	* Some modifications to XOR handling: should now behave like OR and
	  AND - doesn't need to be binary.  (*untested*)

	* Fixes to serialisation code in socketcommon.cc to work with new
	  OmQuery::Internals - this should really be done in
	  OmQuery::Internal.

	* One tiny fix in tcpclient.cc - an &fdset was missed for exception
	  conditions in a select() call.

	* Testsuite modified and expanded to check changes to OmQuery.

Mon Feb 26 18:20:16 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Fixed some compiler warnings reported by James Aylett.

Mon Feb 26 14:27:09 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Avoid waiting for a timeout when closing a SocketClient.

Fri Feb 23 14:38:09 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Updated todo.xml

Thu Feb 22 18:14:41 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* OmRegexFilterNode has an output for non-matching strings as
	  well as matching.  "out" output renamed to "matching".

Thu Feb 22 16:56:33 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Fixed a bug in the fetch() bits: requesting documents at the
	  same time from different OmMSet instances could cause a
	  document to disappear from the cache at the wrong moment.

Thu Feb 22 15:39:49 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Updated todo.

Thu Feb 22 12:14:12 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Some small changes in quartz to improve exception safety and
	  error checking.

	* Remove unwanted OmExpandWeight::get_expand_k() method.

Wed Feb 21 19:02:44 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Overhauled the OmMSet::fetch() etc. methods.  Documents are
	  requested when fetch() is called, but are only fetched (all
	  at once) when the first get_document() is called.

Wed Feb 21 19:30:20 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add an errorhandler member to MultiMatch, and remove it from
	  various calls which used to pass it about.

	* Add an EmptyMatch object, which always returns an emptypostlist.

	* Implement errorhandlers at start of query for initially down
	  nodes.  Improve test for errorhandlers to cover many more cases.

	* Add many debug messages to error handling code.

Wed Feb 21 14:33:50 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Use a deque<> directly instead of a queue, due to conflict
	  with Solaris headers.

	* Split the collect_doc loop into a seperate function

	* SocketClient should be more robust against request_doc() being
	  used without collect_doc().

Tue Feb 20 18:01:13 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* SocketClient implements a queue/cache system which means that
	  collect_doc() doesn't need to be called in the same order as
	  request_doc().

Mon Feb 19 15:43:49 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Converted btree code to use new/delete instead of [mc]alloc/free.

Mon Feb 19 13:52:23 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Added new test collapsekey2 designed to work with muscat36
	  databases, which have different key handling.  Added two new
	  categories of tests to cope with this.

	* Adjusted BackendManager's key generation, and updated
	  test_specialchars1() accordingly.

Fri Feb 16 17:26:59 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Implemented a test for keep-alives

	* Added "-tNNNN" option to omprogsrv to pass a timeout value in.

	* Added get_network_database() in apitest to set the timeout.

Fri Feb 16 16:13:47 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Incremented the remote protocol version, since a new message
	  type has been added.

Fri Feb 16 15:55:31 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Added an OmDatabase keep_alive() method to gently prod any
	  remote databases.  Applications can use it to avoid the remote
	  servers timing out between queries.  Not properly tested yet...

Thu Feb 15 19:05:24 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* The remote server now supports a seperate timeout used while
	  idle, rather than actually servicing a request from the client.
	  Options --idle-timeout and --active-timeout added to omtcpsrv,
	  and --timeout sets both timeouts.

	* Added a documentation comment or two.

Wed Feb 14 18:43:00 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* In Muscat3.6 backends, don't read the key from the keyfile unless
	  keyno is 0.

Tue Feb 13 13:57:34 GMT 2001 Andy MacFarlane <andym@omsee.com>

	* Added parameter expand_k in omsettings in order to change
	  value of weighting in expand process.

Tue Feb 13 13:25:45 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Network timeouts now apply to write() operations as well
	  as read().

	* SocketLineBuf::do_writeline() now correctly deals with EAGAIN.

	* SocketServer has new method writeline() which handles write
	  access to the OmLineBuf.

Mon Feb 12 12:35:41 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Make OmPositionListIterators and any other appropriate iterators
	  (postlist, termlist) have a default constructor allowing them to
	  be declared uninitialised.

Mon Feb 12 10:51:41 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Updated todo.xml

Thu Feb  8 17:59:44 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Moved omnodepad.h from include/om to indexer/indexgraph/

	* Updated todo.xml

Thu Feb  8 17:35:45 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Updated todo.xml

Thu Feb  8 17:00:02 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Quartz now has a metafile which for now has a magic string
	  and a version number.

	* sys_open_to_read() and delete_file() exported from btree.cc.
	  The latter was renamed to sys_unlink_if_exists().

	* Include btree_types.h from btree_util.h

Wed Feb  7 17:33:00 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Fix to InMemory databases: terms can be added even if they
	  don't have any positions.  (Was causing adddoc2 to fail).

Tue Feb  6 18:06:13 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Rename OmMSet::fetch_items() to fetch().  Add an overloaded
	  fetch() method taking a single iterator, to fetch a single item.

	* Fix some documentation comments.

Mon Feb  5 19:16:45 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Update TODO

Mon Feb  5 19:12:39 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Test behaviour of OmDocument methods add_term(), set_wdf(),
	  remove_posting() and remove_term().  Fails for inmemory databases.

Mon Feb  5 17:46:16 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Modified the behaviour of timeouts during a match.  Internally,
	  an absolute timeout time is set from start_match().  Now remote
	  nodes should timeout at NOW + remote_timeout, rather than
	  waiting remote_timeout milliseconds for each read().  Needs
	  some more testing.

Mon Feb  5 17:21:52 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix a missing #include in socketcommon.h

Mon Feb  5 17:15:46 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Sort generated todo lists.

Fri Feb  2 17:44:54 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add an OmDocument::add_term() method.

	* Remove an unwanted check that wdf's are greater than 0: wdf of 0
	  _is_ allowed.

Fri Feb  2 15:04:08 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Hopefully, a fix for segfaults/assertions when network errors
	  happen halfway through a match, when handled by OmErrorHandler
	  objects: give the place-holder EmptyTermLists weighting objects.

Thu Feb  1 19:03:10 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Fixes to OmDocument interface: add parameters specifying the
	  changes to be made to the wdf to add_posting and remove_posting,
	  properly implement remove_posting and remove_term, including
	  throwing of exceptions, and add a set_wdf() method to set the wdf
	  to an absolute value.  Corresponding modifications to
	  OmDocumentTerm.

	* Fix commented out errorhandler code in multimatch.cc, so it still
	  compiles.

	* Add a check to avoid division by zero in bm25weight.cc

Thu Feb  1 15:59:30 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add a missed #include to omqueryinternal.h

Thu Feb  1 14:44:04 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add some error handler code, with a "#if 0"ed out comment,
	  to multimatch.cc

Wed Jan 31 15:45:16 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Remote servers should close down more gracefully when the
	  client closes down in the middle of a request.

Tue Jan 30 16:52:05 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Removed unneeded #includes of STL headers from API headers.

	* All #includes of files which are not installed use "" rather than
	  <>.  This means all #includes of OM files except for those which
	  are in example programs (and hence might be compiled against the
	  installed library).  "" search paths are a superset of <> search
	  paths: hence this should ensure that the om headers work however
	  they are used.

	* Moved supplied OmExpandDecider subclasses into
	  include/om/omexpanddecider.h

	* Remove om_termname_list from API: not used except by code which
	  displays it, and in testsuite.

Tue Jan 30 12:45:22 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Removed #include <vector> from omstem.h

Tue Jan 30 11:09:29 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* OmStem::get_available_languages() now returns a string
	  rather than a vector.  Languages are space-separated.
	  Updated apitest.

	* Added definition of RTLD_DEFAULT to internaltest.cc

Mon Jan 29 16:11:15 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* OmIndexerMessage's copy-on-write slightly more careful.

	* Improved debugging in OmIndexerNode

	* Fixed a bug in the termlistadd node - it tried to append to a
	  non-vector.

Fri Jan 26 16:21:09 GMT 2001 Olly Betts

	* indexerxml.cc: Removed some dead code.

Fri Jan 26 16:11:13 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Added omindexerdescinternal.h to the Makefile

Fri Jan 26 15:50:32 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Move OmQuery definition into a separate header file.

Fri Jan 26 15:46:42 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Move OmQuery::OP_LEAF out of public visibility, by taking it out
	  of the enum, making it a static const member of OmQuery::Internal,
	  and introducing an OmQuery::Internal::op_t to store query
	  operators in internally.  We lose the ability for the compiler to
	  warn us if we forget to check for a particular operator in a
	  switch statement, but this can't really be avoided.

Fri Jan 26 13:49:33 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Added get_output_{node,pad} to OmIndexerDesc

	* Implemented and testes OmNodeInstanceIterator

	* Implemented OmIndexerBuilder::build_from_desc, which somehow
	  hadn't been.  indextest now uses it.

Thu Jan 25 18:47:08 GMT 2001 Olly Betts

	* Fixed various .cvsignore files (omus -> omsee, and
	  bindings/java/.cvsignore which seemed to have been copied from
	  the top level one at some point).

	* Fixed bug in OrPostList when used in a pure boolean context
	  (uninitialised variables).

	* tests/internaltest.cc: removed unused reference to getopt.h.

	* tests/stemtest.pl.in: removed lots of bogus semicolons after
	  closing braces.

Thu Jan 25 17:53:08 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Turn debugging messages (OM_DEBUG_TYPES) off by default.

	* Add todo items for release to pages generated for website.

Thu Jan 25 15:11:14 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Add a couple of documentation comments: we need many more of
	  these.  No method, and certainly no class, in the API should be
	  without an explanatory comment (not least so that they're
	  accessible from the doxygen browser).

Thu Jan 25 14:51:55 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Hide the internals of OmIndexerDesc, and adding member functions
	  to do all the necessary operations (not all yet implemented).

	* Indexer internals mostly deal with OmIndexerDesc::Internal

	* Removed '#include <vector>' from omindexerdesc.h

Thu Jan 25 13:45:49 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* When setting up an RSet, allow documents to be referenced by
	  OmMSetIterator, for convenience.

	* Allow OmMSetIterators and OmESetIterators to be created without
	  initialising, also for convenience.

	* Include CFLAGS for STLPORT in the flags produced by omsee-config.

	* Change several more missed "omus"s to omsee.

Thu Jan 25 13:50:06 GMT 2001 Chris Emerson <chris.emerson@omsee.com>

	* Changed a mention of libomus in netprogs/Makefile.am to libomsee

Thu Jan 25 12:33:46 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Build only the API docs when making dist / install.  Full source
	  docs only get built if explicitly asked for.

Thu Jan 25 11:36:39 GMT 2001  Richard Boulton <richard.boulton@omsee.com>

	* Project name changed to Omsee.

	  Ramifications from a technical viewpoint are:

	  - library name changed from libomus.* to libomsee.*
	  - libomus-config renamed to omsee-config
	  - Autoconf macro file libomus.m4 renamed to omsee.m4,
	    macro name OM_PATH_LIBOMUS changed to OM_PATH_OMSEE
	    and macro now defines OMSEE_CFLAGS and OMSEE_LIBS rather
	    than LIBOMUS_CFLAGS and LIBOMUS_LIBS.  configure arguments
	    changed name, also.

Wed Jan 24 15:57:10 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Improve test of OmMSetIterators equality comparisions.

	* Update TODO

Wed Jan 24 15:11:11 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Renamed OmNodeConnection to OmNodePad.  The old name was
	  confusing.

	* Added OmPadIterator, and OmNodeDescriptor::{in,out}puts_{begin,end}.
	  Also implemented OmNodeDescriptor::get_type()

	* Added output function for OmPadIterator

	* Added test for OmPadIterators

Tue Jan 23 19:01:29 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Remove OmBatchEnquire from system: it may return at a later date,
	  but for now it is simply out of date and a maintainance liability,
	  and gives no significant advantage.  Code now exists in
	  ombatchenquire.h in CVS, but is not part of build process.

	* Make OmEnquire and OmMSet have reference counted internals: this
	  introduces a further layer of indirection, but tidies up things
	  greatly.

	* Remove get_docs() and get_doc() methods from OmEnquire.
	  get_doc(docid) is catered for by OmDatabase::get_document(docid).
	  Added OmMSetIterator::get_document() to replace get_doc on a
	  MSetIterator.  Added OmMSet::fetch_items() to replace get_docs():
	  it prefetches the documents (or just those specified by some
	  MSetIterators into a cache in the Mset).

	* OmMSet internals now have a reference to the creating OmEnquire
	  object: this is set up after the mset returns from the matcher.
	  If the reference is null, the Mset was created standalone, and
	  get_doc methods will fail.

	* OmMSetIterators now have a reference to the MSet, instead of a
	  percent_factor stored.  This allows the percent_factor to be
	  lazily calculated, and also allows get_doc to work.

	* Add get_rank() method to OmMSetIterators.

	* Improve introspection on OmDocument, and fix a bug with assignment
	  of OmDocument (wasn't assigning most of the internals).

	* Add a missing std:: on a string in omstopwordnode.

	* Fixed several documentation comments.

	* Add some more debugging to quartz.

	* Update TODO.

	* Add test_fetchdocs1 to apitest.  Disable test_batchquery1.

	* Remove sign comparison error in VectorTermList.

Tue Jan 23 16:24:04 GMT 2001 Olly Betts

	* No longer compile with -ansi under gcc - it causes problems by
	  preventing Linux system headers defining various functions we need.

	* testsuite/testsuite.cc: when reporting exceptions, display
	  exception's errno value if set.

Tue Jan 23 15:13:58 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Killed OmIndexerBuilder::NodeType.  Now use OmNodeDescriptor
	  in its place, getting rid of another vector usage in the API.

	* OmNodeDescriptor adjusted for its new role: internals are
	  refcounted, and some query as well as setting functions.

	* Cast the fourth argument to getsockopt() to void *.  On Solaris
	  that argument is char *.

Tue Jan 23 11:24:13 GMT 2001 Olly Betts

	* Tiny tweak to da_document.cc.

Fri Jan 19 18:36:15 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Removed get/set vector methods from OmSettings

	* Remote/prog arguments now passed in a string separated be spaces,
	  not a vector.

	* split_words() moved from netutils.h to utils.{h,cc}

	* Some unnecessary #include <vector> lines removed from API headers

	* Removed get_config_vector() from OmIndexerNode

	* OmConstantNode no longer handles vector values, and
	  OmStopWordNode and OmSelectItemsNode use space-separated
	  values instead.

Thu Jan 18 17:31:55 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Removed mentions of std::vector from OmIndexerMessage, and
	  updated the relevant bits.

	* Fixed a bug with the copy-on-write parts of OmIndexerMessage.

Thu Jan 18 17:09:43 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix to btreetest.cc: shouldn't fail if test data files are not
	  available.

	* Fix to multimatch.cc: clamp hits values to number of documents
	  matched after collapsing and match functors, rather than before.

Thu Jan 18 14:13:21 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix error messages thrown by quartz when a database doesn't exist /
	  already exists and isn't to be overwritten.

	* Make quartz clean up an old database directory, if
	  database_allow_overwrite is specified, so that old base files don't
	  confuse things.

Wed Jan 17 18:18:50 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Added all used toplevel directories to DIST_SUBDIRS

Wed Jan 17 18:13:50 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Martin committed changes to btree.cc which should fix some random
	  problems experienced with quartz.

	* Added in a test framework for the btree code, which exhibited the
	  bug fixed by martin until updating to his fixed version.

Wed Jan 17 16:10:02 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Moved the socklen_t definition so that tcpclient.cc could see
	  it.

Tue Jan 16 20:35:18 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix creation of quartz databases in backendmanager: all tests should
	  now pass.

Tue Jan 16 20:28:46 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix quartztest so that the tables / databases get created.
	  Implement new test "create1" to check that creation of databases
	  works as specified.

	* Fix test for whether we are allowed to overwrite a database.

	* Implement much better logging from quartz when making new databases.

	* Clean up an error message from btree.cc

Tue Jan 16 19:24:49 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Don't display messages about allocation failures in the first
	  iteration: if the failures go away when repeating, we're not
	  interested.

Tue Jan 16 18:28:03 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add two new OmSettings, for use when opening databases:
	  database_create and database_allow_overwrite.  The idea is that
	  databases will only be created if database_create is specified,
	  and that when they are being created an exception will be thrown
	  if there's an existing database unless database_allow_overwrite
	  is specified.

	* Implemented database_create and database_allow_overwrite for
	  Quartz, which is the only relevant type for now.  Note that this
	  breaks the testsuite, quite badly.

	* Add OmDatabaseCreateError, which is thrown when creating a database
	  fails.

Tue Jan 16 17:08:47 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed a typo in -ldl detection

Tue Jan 16 15:15:30 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Remove OmNeedRecoveryError, and quartz's quartz_perform_recovery
	  parameter.  Quartz now always performs recovery if needed: there
	  is no need for this added complication.

	* Update TODO

Tue Jan 16 14:25:03 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Changed references to SIGCLD to SIGCHLD as it's more portable.

Tue Jan 16 14:02:34 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Added check for whether -ldl is necessary.

Tue Jan 16 11:51:25 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Added compatibility bits for early libxml1 versions.

Mon Jan 15 18:18:01 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Removed use of hstrerror, which isn't portable.

Mon Jan 15 18:02:42 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix assertion which was the wrong way round in multimatch.cc

Mon Jan 15 17:46:13 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix initialisation of Btree_base::sequential when creating database.

Mon Jan 15 15:43:46 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Renamed some uses of XML node structure for libxml2 compatibility.

Mon Jan 15 15:35:50 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add some fixes to sequential access to btrees from Martin.

Mon Jan 15 12:23:02 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Set matches_* to the known value of the number of hits if we have
	  been unable to return as many hits as were requested, and therefore
	  know the exact number.

	* Update test_matches1() to check this works correctly.  Passes.

Fri Jan 12 17:45:27 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Implement get_doclength() for QuartzDatabase

	* Remove unused parameter from QuartzRecordManager::add_record()

Fri Jan 12 17:14:16 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed MultiAllTermsList, which had stopped working.

Fri Jan 12 15:32:34 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add test to apitest (postlist6) that doclengths got from postlists
	  are the same as those from databases.  Fails for Quartz for the
	  moment.

	* Add test to quartztest (disktable3) to try and bring out a bug in
	  adding to tables.

Fri Jan 12 15:20:09 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix STLport macro so that it will accept an STLport installation
	  with foo/include/stlport and foo/lib instead of foo/stlport and
	  foo/lib.

Fri Jan 12 14:04:37 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed buglet in configure.in which produced a bogus warning
	  about regex libraries.

	* Added an AC_MSG_RESULT corresponding to an AC_MSG_CHECKING
	  for the libxml flags

Fri Jan 12 13:18:07 GMT 2001 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed skip_to() in QuartzAllTermsList

Fri Jan 12 12:52:57 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Turn debugging off in btree.cc: accidentally committed a version
	  with lots of verbose debugging on.

Fri Jan 12 11:16:17 GMT 2001 Olly Betts

	* glibc 2.2 needs `#define _GNU_SOURCE' to give us RTLD_NEXT.

	* C++ comments changed to C comments in malloccheck.c.

Thu Jan 11 16:42:07 GMT 2001 Olly Betts

	* Removed unnecessary `#include "alltermslist.h"' from
	  d[ab]_database.h.

Wed Jan 10 14:28:10 GMT 2001 Olly Betts

	* Updated various .cvsignore files.

Tue Jan 09 19:03:12 GMT 2001 Olly Betts

	* Tidied up dead code from OmAllTermIterator.

Tue Jan 09 18:41:21 GMT 2001 Olly Betts

	* OmAllTermsIterator merged into OmTermIterator.

	* When iterating over all terms, skip_to() doesn't set at_end()
	  when it skips off the end.  Fixed except for quartz and added
	  regression test (allterms3).

Tue Jan  9 18:14:04 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add some extra debugging code into btree code in quartz.

Tue Jan  9 17:22:12 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Make skip_to() work (ie, do nothing) on OmTermIterators, when the
	  term iterator is at_end() already.

Tue Jan  9 13:32:08 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Updates to make the quartzdump utility more useful.

	* Added new test to test cursor behaviour in quartz.

Tue Jan  9 11:31:26 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Remove an item from TODO

Tue Jan  9 10:27:35 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add a missing \ in tests/Makefile.am

Mon Jan  8 19:03:42 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Increment format number in quartz/btree_base.cc.  This isn't
	  actually due to a change in the btree format, but to ensure that
	  some databases which were causing problems are rebuilt.

	  We need to add quartz format numbers, separate from the btree format
	  numbers, to check this kind of thing.

Mon Jan  8 15:13:04 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add some debugging, and fix a test data file.

Mon Jan  8 13:49:50 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix failure to initialise OmMSet::Internal::have_percent_factor.

Thu Jan  4 17:21:24 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add new test for a postlist with many documents, designed to fail
	  and exhibit the bug andy has found.  So far doesn't fail.

Wed Jan  3 19:30:30 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Add get_percent method to OmMSetIterator.  Untested.

	* Add om_percent type to om_types.

	* Add test of sort order of terms in get_matching_terms.

Tue Jan  2 15:05:53 GMT 2001  Richard Boulton <richard.boulton@open.muscat.com>

	* Move documentation of parameters for OmSettings out of omsettings.h
	  and into docs/.  Not in distribution at the moment: it is awaiting
	  placement into a permanent home (I think the user manual is the
	  correct place).

	* Add a bm25weight_min_normlen parameter: this specifies a cutoff
	  on the minimum value that can be used for a normalised document
	  length: smaller values will be forced up to this cutoff.  This
	  prevents very small documents getting a huge bonus weight.

Wed Dec 20 16:54:41 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix warning in QuartzTable

Wed Dec 20 15:13:05 GMT 2000 Olly Betts

	* OmTermListIterator merged into OmTermIterator.

	* Added OmRSet::contains() - checks if an RSet contains a given
	  docid.

	* Methods returning `const om_termname' now just return
	  `om_termname'.

Tue Dec 19 16:55:02 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Implemented AllTermsIterator for DA and Multi databases.
	  Added a test which actually uses a multidatabase, but
	  disabled it as it currently fails for both Quartz and DA.

Tue Dec 19 12:14:05 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Adjusted TODO

Tue Dec 19 20:06:43 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Escaping for termnames in remote database communication modified
	  to use only characters in range 33 to 126.  Should now work on all
	  architectures.

	* Increased OM_SOCKET_PROTOCOL_VERSION to 8.

Mon Dec 18 17:23:48 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added "match_cutoff" option to get_mset OmSettings.

	* Added test for "match_cutoff" to apitest.

	* Updated todo.xml

Mon Dec 18 17:19:40 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Implemented opening positionlists from inmemory databases.  Added
	  a testcase as well, which is run for quartz and inmemory.

Mon Dec 18 15:48:16 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Implemented AllTermsIterator for quartz.  Interaction with
	  QuartzPostList needs to be cleaned up.

	* Added new functions [un]pack_string_preserving_sort(), which
	  pack a string in a way which preserves sort order.  Added a
	  testcase to quartztest.

	* Now use [un]pack_string_preserving_order() on postlist keys, so
	  that we can get at terms in sorted order.  (And get_tname_from_key()
	  added to separate out the term-unpacking as well as the packing)

	* Enabled test_allterms1 in apitest, but put it in a group of
	  tests only run for inmemory and quartz.  This should be extended
	  to other backends.

Mon Dec 18 14:33:42 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Implemented tests of msetiterator and esetiterator copying and
	  assignment.

	* Fix segfault when assigning to [me]setiterator to end.

	* Updated todo.xml

Mon Dec 18 13:52:53 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Move creation of first key in a quartz postlist into a named
	  function (was scattered through the code).

Mon Dec 18 11:19:53 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Update todo.xml

Mon Dec 18 10:47:42 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Remove const from reverse_iterators in api_db.cc, so get around
	  brokenness of egcs 1.1.2

Mon Dec 18 09:41:54 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added apitest_space.txt to the Makefile.am

Sun Dec 17 16:15:03 GMT 2000 Olly Betts

	* Replaced all API uses of om_termname_list with OmTermIterator.

Fri Dec 15 18:54:10 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Implemented OmAllTermsIterator interface in API.  It works for
	  inmemory - the rest haven't been implemented yet.  The test
	  is commented out.

Fri Dec 15 15:47:53 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Updated TODO.

	* database returns positionlists as AutoPtrs; this neatens some of
	  the code from the previous changelog entry, and makes explicit the
	  ownership of the pointer.  postlists and termlists should be
	  AutoPtrs, likewise.

Fri Dec 15 14:59:41 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Make OmPositionListIterators retrieved from OmPostListIterators
	  valid indefinitely (were only valid until OmPostListIterator was
	  moved).  This makes them consistent with OmPositionListIterators
	  retrieved from OmDatabases.

	* Renamed PostList::get_position_list() to read_position_list.
	  Added PostList::open_position_list() which opens a new positionlist
	  and returns it as an AutoPtr.

Fri Dec 15 13:09:51 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Make TODO.release file, containing TODO items for next release.

Fri Dec 15 12:06:42 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* QuartzDatabases now autoflush after 1000 changes.

Fri Dec 15 11:40:37 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix segfault in quartz_table

Fri Dec 15 11:23:15 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Removed begin/end_session() from quartztest

Thu Dec 14 19:19:40 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Done todo item: For writable databases, make the behaviour currently
	  obtained by calling begin_session() and later end_session() the
	  default behaviour.  If users want the changes to be applied
	  immediately following a change, they should call flush().

Thu Dec 14 17:48:27 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix problem with recalc_maxweight() not being called before a
	  get_maxweight() in multimatch.cc if a node prunes at the top level,
	  since recalculate_w_max wasn't being checked at this point.
	  Introduced helper function getorrecalc_maxweight() to tidy this up.

	* Tidy up Asserts in common/netutils.h.

Thu Dec 14 17:11:17 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Adjusted todo.xml

Thu Dec 14 16:21:27 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Removed handling of OmDatabaseModifiedError in the API - it's
	  up to the users to know what to do.  Disabled quartzoverwrite2
	  as it's now inappropriate.

	* Added OmDatabase::reopen() to help them do so.

	* Adjusted todo.xml

Thu Dec 14 14:38:39 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added another quoting regression test.

Thu Dec 14 14:36:53 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed the quoting _again_, since it broke with backslashes.

Thu Dec 14 12:49:58 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix problems with recalculation of maxweight in postlists, causing
	  AssertParanoid at multimatch.cc:393.  When a prune was happening,
	  recalc_maxweight flag was not always being set, because some
	  {next,skip_to}_handling_prune() methods weren't being passed the
	  matcher, and a default argument of 0 was being used.  I've now
	  removed the default argument and pass the matcher always.

	  Sometimes the recalc could perhaps be avoided, but this is
	  certainly safer for now.

Thu Dec 14 12:30:02 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Sleepcat is now disabled by default.

	* Fixed a problem with tabs not being quoted in the remote case.  All
	  control characters are now quoted.  Incremented the protocol ver
	  number.

Thu Dec 14 11:54:17 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added regression test to check that all characters can be
	  are safe to exist in document keys.

	* Fixed OmDebug so that it can display messages containing zero bytes
	  (use fwrite instead for fprintf)

Wed Dec 13 18:43:40 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add regression tests to apitest to check that OmMSet and OmESet
	  begin() and end() iterators compare equal if the mset is empty.
	  Fix matchfunctor used in test_matchfunctor1 so that it works for
	  Muscat3.6 databases.

Wed Dec 13 18:35:05 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed bugs in OmMSet and OmESet iterators: begin() when the set
	  was empty produced an invalid iterator, and the assignment
	  operators would have failed when end iterators were involved.

	* Added a check in test_matchfunctor1() that the mset returned is
	  not empty.

Wed Dec 13 18:18:09 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Turn off tests involving terms with newlines or zero bytes in terms
	  with Muscat3.6 backends; these can't be expected to work.

Wed Dec 13 18:06:29 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Uncommented the code in pctcutoff1 - test now passes.

Wed Dec 13 17:53:19 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix: m36_key_file parameter wasn't being set with DA flimsy
	  databases (thanks to Mark Hagger).

	* indextest.cc changed to use "\n" instead of endl - compiles
	  with STLport again.

Wed Dec 13 17:27:17 GMT 2000 Olly Betts

	* OmMSet is now an STL compatible container.

	* Om*Iterator::difference_type was unsigned - now signed.

	* net/readquery.ll: fixed compiler warning.

	* Remote backend was defaulting to collapse on key 0.

Wed Dec 13 16:48:49 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Add handling of DatabaseModified to OmEnquire::get_mset()

Wed Dec 13 16:28:47 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Escape zero bytes in the network protocol, since these were
	  breaking things when being passed across as part of keys.

	* Add test of having zero bytes in the collapse keys.

	* In testsuite, only display the context of errors if there is one
	  present.

Wed Dec 13 14:44:46 GMT 2000 Olly Betts

	* Implemented OmMSet::operator[]().

Wed Dec 13 14:30:57 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added support for handling overwritten database conditions.
	  Currently works for OmDocument::get_{data,key}().

Wed Dec 13 13:20:45 GMT 2000 Olly Betts

	* Elaborated API hitlist in todo.xml.

Wed Dec 13 12:28:18 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fix to BackendManager to stop it removing tables prematurely.

Wed Dec 13 11:49:53 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Apply the stemmer to query terms used in spaceterms1.  (Not doing
	  so caused the test to fail spuriously on local databases, since the
	  terms are stemmed at index time).  The test still fails with da and
	  db databases.

	* Fixed a problem when stats were unpacked from the network stream,
	  where term names were not correctly unquoted.  This led to double
	  quoting of global statistics.

Wed Dec 13 02:49:05 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Implement copy and assignment methods for OmPositionListIterator.

Wed Dec 13 02:37:14 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* ESet and MSet iterators now cope with being copied / assigned when
	  the internals are null.

	* Added copy method to OmPositionListIterator interface.  No
	  implementation for this yet though, or for the already existing
	  assignment method.

	* Added a couple of easy items to the todo list to check regarding
	  iterators.

Wed Dec 13 02:19:50 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix small bug in mset_range_is_same{,_weights}()

Wed Dec 13 02:07:59 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* And add copy and assignment for OmESet, similarly.

Wed Dec 13 01:58:38 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add copy and assignment operators to OmMSet so that the internals
	  get copied (rather than just the pointer to them).  Really want a
	  small internals class, holding a refcount to the real internals, or
	  else to use refcntptrs for the members of OmMSet::Internal which are
	  potentially large (eg, items)

Wed Dec 13 01:05:44 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add Asserts to api/omdatabaseinternal.cc to ensure that there is at
	  least one database present when opening termlists, etc.  This should
	  really be done by throwing errors.

	* Add destructor to OmMSet, deleting internals.

	* Implement getting positionlists from QuartzDatabases.

	* Fix bug in copy constructor of OmDocument::Internal - some fields
	  were not being copied.

	* Fix api_db.cc so it compiles: code referring to mset by subscripting
	  temporarily commented out.

Tue Dec 12 20:05:10 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix bug with truncation of intermediate keys in btrees.

Tue Dec 12 18:33:12 GMT 2000 Olly Betts

	* OmMSet::get_docs() now takes sane parameters.

	* Various test programs updated to nearly work with new OmMSet
	  interface.

Tue Dec 12 17:18:33 GMT 2000 Olly Betts

	* Finished cleaning up OmMSet; updated TODO to reflect this.

Tue Dec 12 17:16:02 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix bug with sorting keys in btrees.

	* Various fixes to quartzdump.

Tue Dec 12 15:40:28 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Nettest compiles with new OmMSet interface.

Tue Dec 12 15:09:14 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed an endless loop in QuartzWritableDatabase::do_delete_document.

Tue Dec 12 15:07:39 GMT 2000 Olly Betts

	* OmMSetItem replaced by OmMSetIterator.

	* Added OmESet::empty().

	* Fixed == on OmESetIterator.

Tue Dec 12 14:16:57 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Renamed arguments to compare_keys()

Tue Dec 12 12:05:24 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added quartzdump utility to dump the contents of a quartz table.

Tue Dec 12 10:54:44 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added constructors and destructor to OmRSet.

Mon Dec 11 16:32:07 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Remove caching of average length in OmDatabaseInternal, was breaking
	  asking for the average length of a database which was being
	  modified.

Mon Dec 11 16:03:46 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* If no documents in database, don't divide by zero in
	  omdatabaseinternal.cc

	* If a document object doesn't come from the database, when iterating
	  through its termlist don't open postlists from the nonexistant
	  database; open them from the DocumentTerm objects in the document
	  instead.

	* Remove old unused and undefined method
	  OmDocument::Internal::add_posting()

Mon Dec 11 13:53:18 GMT 2000 Olly Betts

	* omenquire.h: Removed superfluous declaration of OmMSetCmp.

Mon Dec 11 13:38:12 GMT 2000 Olly Betts

	* Updated TODO list.

Mon Dec 11 13:24:45 GMT 2000 Olly Betts

	* OmRSet internals encapsulated.

Mon Dec 11 12:42:02 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* OmIndexerMessage::get_element and ...::operator[] now have
	  non-const versions.  Fixes const-warning in omstemmernode.cc.

Mon Dec 11 12:17:32 GMT 2000 Olly Betts

	* Better typedef-s for Om*Iterator::difference_type.

Sun Dec 10 17:51:41 GMT 2000 Olly Betts

	* Corrected various typedef-s for Om*Iterator.

Sun Dec 10 17:28:59 GMT 2000 Olly Betts

	* Updated TODO to reflect OmESet being cleaned up.

	* Term position argument to OmDocument::add_posting() is now
	  optional (as it was for OmDocumentContents).

Sun Dec 10 16:55:17 GMT 2000 Olly Betts

	* OmESetItem is dead - long live OmESetIterator!

	* net/socketclient.cc: fixed compiler warning.

	* net/socketserver.cc: fixed compiler warning.

Sun Dec 10 13:29:15 GMT 2000 Olly Betts

	* Started to encapsulate OmESet/OmESetItem interface.  Interface is
	  close, but currently implementation is exposed in omenquire.h.

	* apitest wasn't running puncterms1 or spaceterms1 - fixed.

Sun Dec 10 11:34:39 GMT 2000 Olly Betts

	* om/autoptr.h -> autoptr.h in lots of places.

Fri Dec  8 17:20:04 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Updated indextest to not use AutoPtr<OmIndexer>

Fri Dec  8 17:14:09 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Oops - removed one too many #include "autoptr.h"

Fri Dec 08 16:50:42 GMT 2000 Olly Betts

	* Updated TODO.

Fri Dec  8 16:44:26 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* IndexerBuilder now returns OmIndexer objects instead of
	  AutoPtr<OmIndexer>.  OmIndexer's internals are reference
	  counted.

	* Moved autoptr.h from include/om to common/, since it's no
	  longer used in the API.

Fri Dec  8 16:22:48 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed omstemmer node bug and made debug slightly more verbose
	  in indextest.cc.

Fri Dec  8 16:13:36 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added a test for OmIndexerMessage to indextest

	* Added output operator for OmIndexerMessage

	* Fixed a bug introduced into omvectorsplit node

	* Changed couts in indextest.cc to touts.

Fri Dec 08 14:53:24 GMT 2000 Olly Betts

	* quartztest: removed OmDocumentTerm reference so that it'll
	  compile (tests fail though).

Fri Dec  8 14:42:46 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* OmIndexerMessage is now a class by itself, replacing OmIndexerData
	  and the typedef to AutoPtr<OmindexerData>.  It's now a copy-on-write
	  object.

	* The indexer stuff all changed.

Fri Dec 08 14:24:02 GMT 2000 Olly Betts

	* omindexdoc.{cc,h}: no longer used so removed.

	* Pushed OmDocumentTerm from API level into the internals of the
	  library.

	* Updated TODO.

Fri Dec 08 12:08:49 GMT 2000 Olly Betts

	* delve: if just given a database (or list of databases), report the
	  number of documents and average document length.

Thu Dec  7 20:39:24 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fix bug: Om*Iterators which were created over empty lists didn't
	  have null internals, causing them not to compare equal to end
	  iterators.

	* Added many asserts to iterator code.

Thu Dec  7 20:02:43 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Removed OmTermListIteratorMap - OmTermListIterator can now be
	  across either a map or an actual termlist.

	* Om*Iterator classes all now delete internals when reaching end,
	  freeing resources sooner and making the comparison operators much
	  simpler.

Thu Dec  7 18:33:03 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Updates to TODO

Thu Dec  7 18:32:39 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Implementation of write locks for Quartz

Thu Dec  7 18:28:55 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fix to backendmanager which doesn't return writable databases
	  unnecessarily (which breaks things when there are write locks)

Thu Dec  7 18:25:50 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added test for Quartz write locks

Thu Dec  7 17:56:19 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add OmDocument::set_data() method which takes a string, instead of
	  an OmData object.  This allows, implicitly, use of const char *'s
	  as well.

	* Further fixes to quartztest.  It now compiles (though I've not
	  tried linking it yet...)  :)

Thu Dec  7 17:49:50 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed omkeylistiterator return types.

Thu Dec  7 17:27:57 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Moved get_document() from OmWritableDatabase to OmDatabase.

	* Added -> operator to OmKeyListIterator.  Fixed return values
	  and constness of Om*Iterator::operator *() methods.

	* Some fixes to quartztest.cc, but not enough to get it compiling.

Thu Dec 07 16:21:28 GMT 2000 Olly Betts

	* Some work on getting quartztest working.

Thu Dec 07 16:10:00 GMT 2000 Olly Betts

	* The library now builds, but "make check" still fails.

Thu Dec  7 15:39:19 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fixes to testsuite/index_utils.cc to not segfault.

Thu Dec  7 14:31:56 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Fixes to api_db.cc so that it compiles.

Wed Dec  6 18:50:48 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add test for terms with spaces, newlines, zero bytes, or
	  backslashes.

	* Updates to TODO

Wed Dec 06 18:18:16 GMT 2000 Olly Betts

	* Woohoo!  Now builds with just --disable-indexer!
	  (still doesn't pass any tests).

Wed Dec 06 17:24:19 GMT 2000 Olly Betts

	* Minor fix.  Now builds with --disable-indexer
	  --disable-quartz-backend (but doesn't pass any tests).

Wed Dec 06 16:35:34 GMT 2000 Olly Betts

	* Fixed up lots of build errors.

Wed Dec 06 14:56:59 GMT 2000 Olly Betts

	* Begin the long job of replacing OmDocumentContents with
	  OmDocument.  Won't currently build - expect the tree to be broken
	  for a few days.  As usual, if you want a working build, use the
	  "snapshot_latest" tag.

Wed Dec  6 12:03:44 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Backed out yesterday's overwritten-handling stuff.

Wed Dec  6 11:36:55 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Increase sleep in tcpclient1 to 3 (did tcpmatch1 last time, duh!)

Tue Dec  5 17:13:38 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* QuartzDocument now has a QuartzTableManager pointer rather than
	  two QuartzTable pointers.

	* QuartzDatabase::do_get_document_internal() copes with Btree
	  overwritten conditions.

	* QuartzDocument methods cope with Btree overwritten conditions

	* New method QuartzTableManager::reopen_tables_because_overwritten()
	  for helping with the above.

	* New test in quartztest for testing overwritten problems from the
	  API rather than just internally to Quartz.

	* Fixed a typo in omsettings.h comment (quartz_dir used to refer to
	  a sleepycat database)

Tue Dec  5 16:53:46 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Update todo.

	* Fix undesirable assert in stats.h

Tue Dec  5 15:41:40 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Replace OmMSet::docs_considered with
	  OmMSet::matches_{lower_bound,estimated,upper_bound}, giving more
	  useful information.

	* PostLists now have get_termfreq_{min,est,max}(), instead of
	  get_termfreq(), so the postlist tree can be used to calculate
	  the matches_* values for the mset.  Implemented for all the
	  postlist subclasses.

	  LeafPostList's still has a virtual get_termfreq() method,
	  and implements get_termfreq_* in terms of it, so database postlists
	  don't need to be modified.

	* Passing of MSets across network modified to pass the new
	  information.

	* PendingMSet uses the values from the mset to return the values
	  of get_termfreq_*().  This assumes that recalc_maxweight has been
	  called first, which is has been.

	* Muscat36 databases get_termfreq() methods fixed to use a
	  LeafPostList rather than a PostList.

	* Renamed test docs_considered1 to matches1, and add several
	  more cases to it.

Tue Dec 05 15:38:27 GMT 2000 Olly Betts

	* Added tests/testdata/apitest_punc.txt to distribution.

Tue Dec 05 15:07:26 GMT 2000 Olly Betts

	* Oops, failed to add new file `tests/testdata/apitest_punc.txt'
	  with last check-in.

Tue Dec 05 14:34:04 GMT 2000 Olly Betts

	* OmTermListIterator implemented for an OmDocument with terms stored
	  in a map rather than coming from a Document.

	* Fixes to remote protocol so solve problems with terms with
	  punctuation in (regression test punc_terms1).

Mon Dec  4 15:02:53 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Makefile tweak in docs/

Mon Dec 04 14:13:05 GMT 2000 Olly Betts

	* More OmDocument work.

Mon Dec  4 11:43:46 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Renamed OmMSet::mbound to docs_considered.

Mon Dec  4 10:11:11 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added some more std:: prefixes for STLport.

Fri Dec  1 17:45:01 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Increase the sleep after the server is started by tcpclient1 to 3
	  seconds so that the server is more likely to have started when
	  then test ran.  This seems to be what was causing the test to
	  randomly fail.  Really, we want a better solution to this (such as
	  the server picking a port and writing it out on stdout once it is
	  listening.)

Fri Dec  1 17:27:02 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Swapped the ports used by tcpclient1 and tcpmatch1 to see if the
	  random failures follow suit.

Fri Dec  1 17:21:07 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Another minor fix to work with STLport.

Fri Dec  1 17:01:02 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add std::'s and similar to fix compilation with STLport.

	* Fix bug in expander due to nth_element being called on the wrong
	  element.  This is the counterpoint of the bug fixed on Nov 24th
	  with the matcher.

Fri Dec  1 16:30:26 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Minor tweaks in error strings.

Fri Dec 01 12:57:59 GMT 2000 Olly Betts

	* Corrected erroneous documentation comment.

Thu Nov 30 18:50:16 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* OmSettings no longer throws exceptions internally (at the cost of
	  slightly more code duplication).

Thu Nov 30 18:05:39 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add a few std::'s to strings which had been missed.

Thu Nov 30 16:41:11 GMT 2000 Olly Betts

	* OmDocument::Internal now knows its OmDatabase.

Thu Nov 30 16:40:33 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add context to network errors thrown from OmSocketLineBuf.

Thu Nov 30 16:21:47 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added a quartz test for largish bitmaps.

	* Fixed the code so that the above test would pass.

Thu Nov 30 16:10:37 GMT 2000 Olly Betts

	* OmDocument::add_posting() pretty much done.

Thu Nov 30 15:51:46 GMT 2000 Olly Betts

	* More work on OmDocument::add_posting().

	* Added OmTermListIterator::positionlist_begin() and
	  OmTermListIterator::positionlist_end().

Thu Nov 30 14:16:28 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Fixed a prototype bug introduced with the last commit.

Thu Nov 30 13:23:14 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Bcursor::find_key now more const-correct.

	* Bcursor_create now returns an AutoPtr.  The resultant changes
	  fixed a memory leak.

	* New exception: OmDatabaseModifiedError.  Thrown when an open
	  revision of a table is no longer valid due to multiple updates.

	* quartzoverwrite1 test re-enabled, and passes.

Thu Nov 30 13:23:27 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* nettest now uses quartz backend: should always run all tests now
	  (apart from tcpdead1, which doesn't work).

Wed Nov 29 19:46:22 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* In testsuite, report the context of Om exceptions as well as their
	  type and message.

Wed Nov 29 18:30:10 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add "remote_connect_timeout" parameter to be supplied when opening
	  a remote database, to specify a separate timeout for the connect
	  operation to that used once the connection has been opened.

	* Add setting of the context of errors thrown by tcpclient or
	  progclient, so that the node which failed can be determined.

Wed Nov 29 17:50:03 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Reworked Btree_base::read() a bit so that it's hopefully more
	  readable.

	* Hopefully fixed a bug when the bitmap approaches 1k.

	* Fix to catch problems re-opening databases after an apply in
	  Quartz.

Wed Nov 29 17:30:26 GMT 2000 Olly Betts

	* Added OmDocument::termlist_begin() and OmDocument::termlist_end()

Wed Nov 29 16:53:13 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Comment out quartzoverwrite1 test so that it doesn't cause problems
	  for other developers.

Wed Nov 29 16:27:19 GMT 2000 Olly Betts

	* docid now in Document class rather than subclasses.

Wed Nov 29 14:54:13 GMT 2000 Olly Betts

	* leafdocument.cc renamed to document.cc

	* Document class now has a pointer to the associated Database class
	  so we can open termlists, etc.

Wed Nov 29 14:03:43 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Add quartztest to test for case when a database block gets
	  overwritten.  Currently, this fails because an exception doesn't
	  get thrown when it should.

Wed Nov 29 13:18:24 GMT 2000 Olly Betts

	* LeafDocument class renamed to Document.

Wed Nov 29 12:35:49 GMT 2000 Olly Betts

	* Added OmDocument::remove_posting(), OmDocument::remove_term(),
	  and OmDocument::clear_terms()

Wed Nov 29 12:31:22 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added another revision number in the middle of the base file,
	  before the bitmap.  Also now check that there isn't any extra
	  data at the end after we finish reading it.  Incremented the
	  database format.

Wed Nov 29 11:55:03 GMT 2000 Olly Betts

	* Added OmDocument::remove_key() and OmDocument::clear_keys()

Tue Nov 28 18:34:57 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Btree bitmap now merged with base - one object, one file.

Tue Nov 28 17:13:56 GMT 2000 Olly Betts

	* Added OmDocument::set_data()

Tue Nov 28 16:47:06 GMT 2000 Olly Betts

	* Started to alter OmDocument to be a general purpose document class
	  which includes the functionality currently in OmDocumentContents.

Tue Nov 28 15:08:38 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Added OmSplitOnCharsNode, which does a subset of OmRegexSplitNode
	  but less slowly.

	* Modified RegexSplit node and regexcommon so that less copying
	  of strings is needed.

Tue Nov 28 13:42:41 GMT 2000 Chris Emerson <chris.emerson@open.muscat.com>

	* Moved the Btree's bitmap into a separate object.

Tue Nov 28 13:06:36 GMT 2000 Olly Betts

	* Eliminated OmDocumentParams.

	* Removed unnecessary mutex from OmDocument::Internal.

Mon Nov 27 18:45:27 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Implement get_position_list() on databases.  Untested.  Also needs
	  some work to make consistent with open_position_list() on posting
	  lists: see todo list.

Mon Nov 27 18:29:00 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Change #define LEVEL ... to #define GET_LEVEL ... in btree_util.h:
	  fixes problem reported by includetest

Mon Nov 27 18:20:42 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added a set of modifications to the todo.xml.  Also, add a
	  "release" field, recording the release that the work must be
	  performed by.

Mon Nov 27 18:08:35 GMT 2000 Olly Betts

	* A RefCntPtr now copes with being assigned to itself (used to
	  delete the underlying object if the reference count was 1).  Added
	  regression test (refcnt2).

	* Now overwrite pointer inside RefCntPtr before deleting the pointed
	  to object so there's no window where another thread can access the
	  pointer and get the just-deleted object.

Mon Nov 27 14:36:59 GMT 2000 Olly Betts

	* OmError class now optionally stores an errno value.

Mon Nov 27 13:04:18 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Quartztest builds its test databases in a subdirectory, which
	  is now in .cvsignore, so we shouldn't get cvs complaining about
	  so many unknown files any more.

Mon Nov 27 12:53:16 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Another TODO item.

Mon Nov 27 12:15:53 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added a couple of new items to the todo list.

Fri Nov 24 19:23:56 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Quartztests now deletes all old tables, so that database formats
	  don't cause problems.

Fri Nov 24 19:03:59 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Added std:: prefix to lots of strings which didn't have it.
	  I've probably added some where they shouldn't be: there were rather
	  a lot of cases of this.

Fri Nov 24 18:27:06 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Major bug fix!  When removing elements, matcher was performing
	  nth_element() on the first element to be thrown away, rather than
	  the lowest element to keep.  This meant that, after throwing away
	  low scoring items, items.back() was a random item rather than the
	  lowest scoring item.  This caused the min weight for getting into
	  the mset to go up faster than it should have done, and generally
	  broke everything.

	  It will be interesting to compare evaluation measures before and
	  after this fix.

Fri Nov 24 15:34:17 GMT 2000  Richard Boulton <richard.boulton@open.muscat.com>

	* Declare this to be version 0.4.1

